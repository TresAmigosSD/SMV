
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>smv package &#8212; Spark Modularized View v2r6 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to smv’s documentation!" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to smv’s documentation!"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Spark Modularized View v2r6 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="smv-package">
<h1>smv package<a class="headerlink" href="#smv-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-smv.csv_attributes">
<span id="smv-csv-attributes-module"></span><h2>smv.csv_attributes module<a class="headerlink" href="#module-smv.csv_attributes" title="Permalink to this headline">¶</a></h2>
<p>SMV User Run Configuration Parameters</p>
<p>This module defined the SmvRunConfig class which can be mixed-in into an
SmvModule to get user configuration parameters at run-time.</p>
<dl class="function">
<dt id="smv.csv_attributes.CsvAttributes">
<code class="descclassname">smv.csv_attributes.</code><code class="descname">CsvAttributes</code><span class="sig-paren">(</span><em>delimiter='</em>, <em>'</em>, <em>quotechar='&quot;'</em>, <em>hasHeader=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/csv_attributes.html#CsvAttributes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.csv_attributes.CsvAttributes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-smv.datasetrepo">
<span id="smv-datasetrepo-module"></span><h2>smv.datasetrepo module<a class="headerlink" href="#module-smv.datasetrepo" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="smv.datasetrepo.DataSetRepo">
<em class="property">class </em><code class="descclassname">smv.datasetrepo.</code><code class="descname">DataSetRepo</code><span class="sig-paren">(</span><em>smvApp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/datasetrepo.html#DataSetRepo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.datasetrepo.DataSetRepo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="attribute">
<dt id="smv.datasetrepo.DataSetRepo.all_project_pymodules">
<code class="descname">all_project_pymodules</code><a class="headerlink" href="#smv.datasetrepo.DataSetRepo.all_project_pymodules" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.datasetrepo.DataSetRepo.dataSetsForStage">
<code class="descname">dataSetsForStage</code><span class="sig-paren">(</span><em>stageName</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/datasetrepo.html#DataSetRepo.dataSetsForStage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.datasetrepo.DataSetRepo.dataSetsForStage" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.datasetrepo.DataSetRepo.loadDataSet">
<code class="descname">loadDataSet</code><span class="sig-paren">(</span><em>fqn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/datasetrepo.html#DataSetRepo.loadDataSet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.datasetrepo.DataSetRepo.loadDataSet" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.datasetrepo.DataSetRepo.load_pymodule">
<code class="descname">load_pymodule</code><span class="sig-paren">(</span><em>fqn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/datasetrepo.html#DataSetRepo.load_pymodule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.datasetrepo.DataSetRepo.load_pymodule" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="smv.datasetrepo.DataSetRepoFactory">
<em class="property">class </em><code class="descclassname">smv.datasetrepo.</code><code class="descname">DataSetRepoFactory</code><span class="sig-paren">(</span><em>smvApp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/datasetrepo.html#DataSetRepoFactory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.datasetrepo.DataSetRepoFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="smv.datasetrepo.DataSetRepoFactory.createRepo">
<code class="descname">createRepo</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/datasetrepo.html#DataSetRepoFactory.createRepo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.datasetrepo.DataSetRepoFactory.createRepo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-smv.dqm">
<span id="smv-dqm-module"></span><h2>smv.dqm module<a class="headerlink" href="#module-smv.dqm" title="Permalink to this headline">¶</a></h2>
<p>SMV DataSet Framework interface</p>
<p>This module defines the abstract classes which formed the SmvGenericModule Framework for clients’ projects</p>
<dl class="function">
<dt id="smv.dqm.DQMFix">
<code class="descclassname">smv.dqm.</code><code class="descname">DQMFix</code><span class="sig-paren">(</span><em>condition</em>, <em>fix</em>, <em>name=None</em>, <em>taskPolicy=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#DQMFix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.DQMFix" title="Permalink to this definition">¶</a></dt>
<dd><p>DQMFix will fix a column with a default value</p>
<p class="rubric">Example</p>
<p>If “age” greater than 100, make it 100</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">DQMFix</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">),</span> <span class="s1">&#39;age_cap100&#39;</span><span class="p">,</span> <span class="n">FailNone</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>condition</strong> (<em>Column</em>) – boolean condition that determines when the fix should occur on the records of a DF</li>
<li><strong>fix</strong> (<em>Column</em>) – the fix to use when replacing a value that does not pass the condition</li>
<li><strong>name</strong> (<em>String</em>) – optional parameter for naming the DQMFix. if not specified, defaults to the condition text</li>
<li><strong>taskPolicy</strong> (<em>DQMTaskPolicy</em>) – optional parameter for the DQM policy. if not specified, defaults to FailNone()</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a DQMFix object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(DQMFix)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.DQMRule">
<code class="descclassname">smv.dqm.</code><code class="descname">DQMRule</code><span class="sig-paren">(</span><em>rule</em>, <em>name=None</em>, <em>taskPolicy=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#DQMRule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.DQMRule" title="Permalink to this definition">¶</a></dt>
<dd><p>DQMRule defines a requirement on the records of a DF</p>
<p class="rubric">Example</p>
<p>Require the sum of “a” and “b” columns less than 100</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">DQMRule</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">col</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">100.0</span><span class="p">,</span> <span class="s1">&#39;a_b_sum_lt100&#39;</span><span class="p">,</span> <span class="n">FailPercent</span><span class="p">(</span><span class="mf">0.01</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>rule</strong> (<em>Column</em>) – boolean condition that defines the requirement on the records of a DF</li>
<li><strong>name</strong> (<em>string</em>) – optional parameter for naming the DQMRule. if not specified, defaults to the rule text</li>
<li><strong>taskPolicy</strong> (<em>DQMTaskPolicy</em>) – optional parameter for the DQM policy. if not specified, defaults to FailNone()</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a DQMRule object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(DQMRule)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.FailAny">
<code class="descclassname">smv.dqm.</code><code class="descname">FailAny</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#FailAny"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.FailAny" title="Permalink to this definition">¶</a></dt>
<dd><p>Any rule fail or fix with FailAny will cause the entire DF to fail</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">policy for DQM Task</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DQMTaskPolicy)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.FailCount">
<code class="descclassname">smv.dqm.</code><code class="descname">FailCount</code><span class="sig-paren">(</span><em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#FailCount"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.FailCount" title="Permalink to this definition">¶</a></dt>
<dd><p>Tasks with FailCount(n) will fail the DF if the task is triggered &gt;= n times</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>threshold</strong> (<em>int</em>) – the threshold after which the DF fails</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">policy for DQM Task</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(DQMTaskPolicy)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.FailNone">
<code class="descclassname">smv.dqm.</code><code class="descname">FailNone</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#FailNone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.FailNone" title="Permalink to this definition">¶</a></dt>
<dd><p>Tasks with FailNone will not trigger any DF level policy</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">policy for DQM Task</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DQMTaskPolicy)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.FailParserCountPolicy">
<code class="descclassname">smv.dqm.</code><code class="descname">FailParserCountPolicy</code><span class="sig-paren">(</span><em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#FailParserCountPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.FailParserCountPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>If the total time of parser fails &gt;= threshold, fail the DF</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>threshold</strong> (<em>int</em>) – the threshold after which the DF fails</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">policy for DQM</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(DQMPolicy)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.FailPercent">
<code class="descclassname">smv.dqm.</code><code class="descname">FailPercent</code><span class="sig-paren">(</span><em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#FailPercent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.FailPercent" title="Permalink to this definition">¶</a></dt>
<dd><p>Tasks with FailPercent(r) will fail the DF if the task is triggered &gt;= r percent of the
total number of records in the DF</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>threshold</strong> (<em>double</em>) – the threshold after which the DF fails. value is between 0.0 and 1.0</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">policy for DQM Task</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(DQMTaskPolicy)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.FailTotalFixCountPolicy">
<code class="descclassname">smv.dqm.</code><code class="descname">FailTotalFixCountPolicy</code><span class="sig-paren">(</span><em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#FailTotalFixCountPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.FailTotalFixCountPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>For all the fixes in a DQM, if the total number of times they are triggered is &gt;= threshold, fail the DF</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>threshold</strong> (<em>int</em>) – the threshold after which the DF fails</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">policy for DQM</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(DQMPolicy)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.FailTotalFixPercentPolicy">
<code class="descclassname">smv.dqm.</code><code class="descname">FailTotalFixPercentPolicy</code><span class="sig-paren">(</span><em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#FailTotalFixPercentPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.FailTotalFixPercentPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>For all the fixes in a DQM, if the total number of times they are triggered is &gt;= threshold * total Records, fail the DF</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>threshold</strong> (<em>double</em>) – the threshold after which the DF fails. value is between 0.0 and 1.0</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">policy for DQM</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(DQMPolicy)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.FailTotalRuleCountPolicy">
<code class="descclassname">smv.dqm.</code><code class="descname">FailTotalRuleCountPolicy</code><span class="sig-paren">(</span><em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#FailTotalRuleCountPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.FailTotalRuleCountPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>For all the rules in a DQM, if the total number of times they are triggered is &gt;= threshold, fail the DF</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>threshold</strong> (<em>int</em>) – the threshold after which the DF fails</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">policy for DQM</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(DQMPolicy)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.FailTotalRulePercentPolicy">
<code class="descclassname">smv.dqm.</code><code class="descname">FailTotalRulePercentPolicy</code><span class="sig-paren">(</span><em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#FailTotalRulePercentPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.FailTotalRulePercentPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>For all the rules in a DQM, if the total number of times they are triggered is &gt;= threshold * total Records, fail the DF</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>threshold</strong> (<em>double</em>) – the threshold after which the DF fails. value is between 0.0 and 1.0</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">policy for DQM</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(DQMPolicy)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.dqm.SmvDQM">
<code class="descclassname">smv.dqm.</code><code class="descname">SmvDQM</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/dqm.html#SmvDQM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.dqm.SmvDQM" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory method for Scala SmvDQM</p>
</dd></dl>

</div>
<div class="section" id="module-smv.error">
<span id="smv-error-module"></span><h2>smv.error module<a class="headerlink" href="#module-smv.error" title="Permalink to this headline">¶</a></h2>
<p>Errors thrown by SMV</p>
<dl class="exception">
<dt id="smv.error.SmvDqmValidationError">
<em class="property">exception </em><code class="descclassname">smv.error.</code><code class="descname">SmvDqmValidationError</code><span class="sig-paren">(</span><em>dqmValidationResult</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/error.html#SmvDqmValidationError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.error.SmvDqmValidationError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#smv.error.SmvRuntimeError" title="smv.error.SmvRuntimeError"><code class="xref py py-class docutils literal notranslate"><span class="pre">smv.error.SmvRuntimeError</span></code></a></p>
<p>This class has an instance of dqmValidationResult(dict)</p>
</dd></dl>

<dl class="exception">
<dt id="smv.error.SmvMetadataValidationError">
<em class="property">exception </em><code class="descclassname">smv.error.</code><code class="descname">SmvMetadataValidationError</code><span class="sig-paren">(</span><em>msg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/error.html#SmvMetadataValidationError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.error.SmvMetadataValidationError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#smv.error.SmvRuntimeError" title="smv.error.SmvRuntimeError"><code class="xref py py-class docutils literal notranslate"><span class="pre">smv.error.SmvRuntimeError</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="smv.error.SmvRuntimeError">
<em class="property">exception </em><code class="descclassname">smv.error.</code><code class="descname">SmvRuntimeError</code><span class="sig-paren">(</span><em>msg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/error.html#SmvRuntimeError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.error.SmvRuntimeError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></p>
</dd></dl>

</div>
<div class="section" id="module-smv.functions">
<span id="smv-functions-module"></span><h2>smv.functions module<a class="headerlink" href="#module-smv.functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="smv.functions.diceSorensen">
<code class="descclassname">smv.functions.</code><code class="descname">diceSorensen</code><span class="sig-paren">(</span><em>c1</em>, <em>c2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#diceSorensen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.diceSorensen" title="Permalink to this definition">¶</a></dt>
<dd><p>2-gram UDF with formula (2 * number of overlaped gramCnt)/(s1.gramCnt + s2.gramCnt)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c1</strong> (<em>Column</em>) – first column</li>
<li><strong>c2</strong> (<em>Column</em>) – second column</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">2-gram</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(Column)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.functions.jaroWinkler">
<code class="descclassname">smv.functions.</code><code class="descname">jaroWinkler</code><span class="sig-paren">(</span><em>c1</em>, <em>c2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#jaroWinkler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.jaroWinkler" title="Permalink to this definition">¶</a></dt>
<dd><p>Jaro-Winkler edit distance metric UDF</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c1</strong> (<em>Column</em>) – first column</li>
<li><strong>c2</strong> (<em>Column</em>) – second column</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">distances</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(Column)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.functions.nGram2">
<code class="descclassname">smv.functions.</code><code class="descname">nGram2</code><span class="sig-paren">(</span><em>c1</em>, <em>c2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#nGram2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.nGram2" title="Permalink to this definition">¶</a></dt>
<dd><p>2-gram UDF with formula (number of overlaped gramCnt)/max(c1.gramCnt, c2.gramCnt)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c1</strong> (<em>Column</em>) – first column</li>
<li><strong>c2</strong> (<em>Column</em>) – second column</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">2-gram</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(Column)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.functions.nGram3">
<code class="descclassname">smv.functions.</code><code class="descname">nGram3</code><span class="sig-paren">(</span><em>c1</em>, <em>c2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#nGram3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.nGram3" title="Permalink to this definition">¶</a></dt>
<dd><p>3-gram UDF with formula (number of overlaped gramCnt)/max(s1.gramCnt, s2.gramCnt)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c1</strong> (<em>Column</em>) – first column</li>
<li><strong>c2</strong> (<em>Column</em>) – second column</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">3-gram</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(Column)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.functions.normlevenshtein">
<code class="descclassname">smv.functions.</code><code class="descname">normlevenshtein</code><span class="sig-paren">(</span><em>c1</em>, <em>c2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#normlevenshtein"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.normlevenshtein" title="Permalink to this definition">¶</a></dt>
<dd><p>Levenshtein edit distance metric UDF</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c1</strong> (<em>Column</em>) – first column</li>
<li><strong>c2</strong> (<em>Column</em>) – second column</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">distances</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(Column)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.functions.smvArrayCat">
<code class="descclassname">smv.functions.</code><code class="descname">smvArrayCat</code><span class="sig-paren">(</span><em>sep</em>, <em>col</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#smvArrayCat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.smvArrayCat" title="Permalink to this definition">¶</a></dt>
<dd><p>For an array typed column, concat the elements to a string with the given separater.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sep</strong> – a Python string to separate the fields</li>
<li><strong>col</strong> – a Column with ArrayType</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a Column in StringType with array elements concatenated</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(col)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.functions.smvCollectSet">
<code class="descclassname">smv.functions.</code><code class="descname">smvCollectSet</code><span class="sig-paren">(</span><em>col</em>, <em>datatype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#smvCollectSet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.smvCollectSet" title="Permalink to this definition">¶</a></dt>
<dd><p>An aggregate function, which will collect all the values of the given column and create a set as an array typed column.
Since Spark 1.6, a spark function collect_set was introduced, so as migrate to Spark 1.6 and later, this smvCollectSet
will be depricated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>col</strong> (<em>Column</em>) – column to be aggregated on</li>
<li><strong>datatype</strong> (<em>DataType</em>) – datatype of the input column</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.functions.smvCreateLookUp">
<code class="descclassname">smv.functions.</code><code class="descname">smvCreateLookUp</code><span class="sig-paren">(</span><em>m</em>, <em>default</em>, <em>outputType</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#smvCreateLookUp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.smvCreateLookUp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Python UDF which will perform a dictionary lookup on a column</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>m</strong> (<em>dictionary</em>) – a Python dictionary to be applied</li>
<li><strong>default</strong> (<em>any</em>) – default value if dictionary lookup failed</li>
<li><strong>outputType</strong> (<em>DataType</em>) – output value’s data type</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">an udf which can apply to a column and apply the lookup</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(udf)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.functions.smvFirst">
<code class="descclassname">smv.functions.</code><code class="descname">smvFirst</code><span class="sig-paren">(</span><em>c</em>, <em>nonNull=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#smvFirst"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.smvFirst" title="Permalink to this definition">¶</a></dt>
<dd><p>Variation of Spark “first” which also returns null values</p>
<p>Since Spark “first” will return the first non-null value, we have to
create our version smvFirst which to retune the real first value, even
if it’s null. Alternatively can return the first non-null value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>(</strong><strong>Column</strong> (<em>c</em>) – column to extract first value from</li>
<li><strong>nonNull</strong> (<em>bool</em>) – If false, return first value even if null. If true, return first non-null value. Defaults to false.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">first value</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(object)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.functions.smvHashKey">
<code class="descclassname">smv.functions.</code><code class="descname">smvHashKey</code><span class="sig-paren">(</span><em>head</em>, <em>*others</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#smvHashKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.smvHashKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Create MD5 on concatenated columns.
Return “Prefix” + MD5 Hex string(size 32 string) as the unique key</p>
<p>MD5’s collisions rate on real data records could be ignored based on the following discussion.</p>
<p><a class="reference external" href="https://marc-stevens.nl/research/md5-1block-collision/">https://marc-stevens.nl/research/md5-1block-collision/</a>
The shortest messages have the same MD5 are 512-bit (64-byte) messages as below</p>
<p>4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa200a8284bf36e8e4b55b35f427593d849676da0d1555d8360fb5f07fea2
and the (different by two bits)
4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa202a8284bf36e8e4b55b35f427593d849676da0d1d55d8360fb5f07fea2
both have MD5 hash
008ee33a9d58b51cfeb425b0959121c9</p>
<p>There are other those pairs, but all carefully constructed.
Theoretically the random collisions will happen on data size approaching 2^64 (since MD5 has
128-bit), which is much larger than the number of records we deal with (a billion is about 2^30)
There for using MD5 to hash primary key columns is good enough for creating an unique key</p>
<p>This function can take 2 forms:
- smvHashKey(prefix, col1, col2, …)
- smvHashKey(col1, col2, …)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>prefix</strong> (<em>String</em>) – return string’s prefix</li>
<li><strong>col.</strong> (<em>Column</em>) – columns to be part of hash</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a StringType column as Prefix + MD5 Hex string</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(col)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.functions.smvStrCat">
<code class="descclassname">smv.functions.</code><code class="descname">smvStrCat</code><span class="sig-paren">(</span><em>head</em>, <em>*others</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/functions.html#smvStrCat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.functions.smvStrCat" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate multiple columns to a single string. Similar to <cite>concat</cite> and <cite>concat_ws</cite> functions in Spark but behaves differently
when some columns are nulls.
The Spark version will return null if any of the inputs is null.
smvStrCat will return null if all of the inputs are nulls, otherwise it will coalesce null cols to blank.</p>
<p>This function can take 2 forms:
- smvStrCat(sep, col1, col2, …)
- smvStrCat(col1, col2, …)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sep</strong> (<em>String</em>) – separater for the concats</li>
<li><strong>col.</strong> (<em>Column</em>) – columns to be concatenated</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a StringType column</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(col)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="smv-graph-module">
<h2>smv.graph module<a class="headerlink" href="#smv-graph-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-smv.helpers">
<span id="smv-helpers-module"></span><h2>smv.helpers module<a class="headerlink" href="#module-smv.helpers" title="Permalink to this headline">¶</a></h2>
<p>SMV DataFrame Helpers and Column Helpers</p>
<p>This module provides the helper functions on DataFrame objects and Column objects</p>
<dl class="class">
<dt id="smv.helpers.ColumnHelper">
<em class="property">class </em><code class="descclassname">smv.helpers.</code><code class="descname">ColumnHelper</code><span class="sig-paren">(</span><em>col</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvArrayFlatten">
<code class="descname">smvArrayFlatten</code><span class="sig-paren">(</span><em>elemType</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvArrayFlatten"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvArrayFlatten" title="Permalink to this definition">¶</a></dt>
<dd><p>smvArrayFlatten helper applies flatten operation on an Array of Array
column.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;arrayOfArrayOfStr&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">smvArrayFlatten</span><span class="p">(</span><span class="n">StringType</span><span class="p">()))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>elemType</strong> (<em>DataType</em><em> or </em><em>DataFram</em>) – array element’s data type,
in object form or the DataFrame to infer the
element data type</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvDay70">
<code class="descname">smvDay70</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvDay70"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvDay70" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a Timestamp to the number of days from 1970-01-01</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvDay70</span><span class="p">())</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">IntegerType. Number of days from 1970-01-01 (start from 0)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(Column)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvDayOfMonth">
<code class="descname">smvDayOfMonth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvDayOfMonth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvDayOfMonth" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract day of month component from a timestamp</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvDayOfMonth</span><span class="p">())</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">IntegerType. Day of month component as integer (range 1-31), or null if input column is null</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(Column)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvDayOfWeek">
<code class="descname">smvDayOfWeek</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvDayOfWeek"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvDayOfWeek" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract day of week component from a timestamp</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvDayOfWeek</span><span class="p">())</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">IntegerType. Day of week component as integer (range 1-7, 1 being Monday), or null if input column is null</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(Column)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvGetColName">
<code class="descname">smvGetColName</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvGetColName"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvGetColName" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of a Column as a sting</p>
<p>Example:
&gt;&gt;&gt; df.a.smvGetColName()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(str)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvHour">
<code class="descname">smvHour</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvHour"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvHour" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract hour component from a timestamp</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvHour</span><span class="p">())</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">IntegerType. Hour component as integer, or null if input column is null</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(Column)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvIsAllIn">
<code class="descname">smvIsAllIn</code><span class="sig-paren">(</span><em>*vals</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvIsAllIn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvIsAllIn" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if ALL of the Array columns’ elements are in the given parameter sequence</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>vals</strong> (<em>*any</em>) – vals must be of the same type as the Array content</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>input DF:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">k</th>
<th class="head">v</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>a</td>
<td>b</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>d</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">smvIsAllIn</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;isFound&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>output DF:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">isFound</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>true</td>
</tr>
<tr class="row-odd"><td>false</td>
</tr>
<tr class="row-even"><td>false</td>
</tr>
</tbody>
</table>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">BooleanType</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(Column)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvIsAnyIn">
<code class="descname">smvIsAnyIn</code><span class="sig-paren">(</span><em>*vals</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvIsAnyIn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvIsAnyIn" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if ANY one of the Array columns’ elements are in the given parameter sequence</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>vals</strong> (<em>*any</em>) – vals must be of the same type as the Array content</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>input DF:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">k</th>
<th class="head">v</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>a</td>
<td>b</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>d</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">smvIsAnyIn</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;isFound&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>output DF:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">isFound</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>true</td>
</tr>
<tr class="row-odd"><td>true</td>
</tr>
<tr class="row-even"><td>false</td>
</tr>
</tbody>
</table>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">BooleanType</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(Column)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvMonth">
<code class="descname">smvMonth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvMonth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvMonth" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract month component from a timestamp</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvMonth</span><span class="p">())</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">IntegerType. Month component as integer, or null if input column is null</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(Column)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvMonth70">
<code class="descname">smvMonth70</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvMonth70"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvMonth70" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a Timestamp to the number of months from 1970-01-01</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvMonth70</span><span class="p">())</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">IntegerType. Number of months from 1970-01-01 (start from 0)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(Column)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvPlusDays">
<code class="descname">smvPlusDays</code><span class="sig-paren">(</span><em>delta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvPlusDays"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvPlusDays" title="Permalink to this definition">¶</a></dt>
<dd><p>Add N days to <cite>Timestamp</cite> or <cite>Date</cite> column</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>delta</strong> (<em>int</em><em> or </em><em>Column</em>) – the number of days to add</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvPlusDays</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>TimestampType. The incremented Timestamp, or null if input is null.</dt>
<dd><strong>Note</strong> even if the input is DateType, the output is TimestampType</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(Column)</td>
</tr>
</tbody>
</table>
<p>Please note that although Spark’s <cite>date_add</cite> function does the similar
thing, they are actually different.</p>
<ul class="simple">
<li>Both can act on both <cite>Timestamp</cite> and <cite>Date</cite> types</li>
<li><cite>smvPlusDays</cite> always returns <cite>Timestamp</cite>, while <cite>F.date_add</cite> always returns
<cite>Date</cite></li>
</ul>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvPlusMonths">
<code class="descname">smvPlusMonths</code><span class="sig-paren">(</span><em>delta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvPlusMonths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvPlusMonths" title="Permalink to this definition">¶</a></dt>
<dd><p>Add N months to <cite>Timestamp</cite> or <cite>Date</cite> column</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>delta</strong> (<em>int</em><em> or </em><em>Column</em>) – the number of months to add</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The calculation will do its best to only change the month field retaining the same day of month. However, in certain circumstances, it may be necessary to alter smaller fields. For example, 2007-03-31 plus one month cannot result in 2007-04-31, so the day of month is adjusted to 2007-04-30.</p>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvPlusMonths</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>TimestampType. The incremented Timestamp, or null if input is null.</dt>
<dd><strong>Note</strong> even if the input is DateType, the output is TimestampType</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(Column)</td>
</tr>
</tbody>
</table>
<p>Please note that although Spark’s <cite>add_months</cite> function does the similar
thing, they are actually different.</p>
<ul class="simple">
<li>Both can act on both <cite>Timestamp</cite> and <cite>Date</cite> types</li>
<li><cite>smvPlusMonths</cite> always returns <cite>Timestamp</cite>, while <cite>F.add_months</cite> always returns
<cite>Date</cite></li>
</ul>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvPlusWeeks">
<code class="descname">smvPlusWeeks</code><span class="sig-paren">(</span><em>delta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvPlusWeeks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvPlusWeeks" title="Permalink to this definition">¶</a></dt>
<dd><p>Add N weeks to <cite>Timestamp</cite> or <cite>Date</cite> column</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>delta</strong> (<em>int</em><em> or </em><em>Column</em>) – the number of weeks to add</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvPlusWeeks</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>TimestampType. The incremented Timestamp, or null if input is null.</dt>
<dd><strong>Note</strong> even if the input is DateType, the output is TimestampType</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(Column)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvPlusYears">
<code class="descname">smvPlusYears</code><span class="sig-paren">(</span><em>delta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvPlusYears"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvPlusYears" title="Permalink to this definition">¶</a></dt>
<dd><p>Add N years to <cite>Timestamp</cite> or <cite>Date</cite> column</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>delta</strong> (<em>int</em><em> or </em><em>Column</em>) – the number of years to add</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvPlusYears</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>TimestampType. The incremented Timestamp, or null if input is null.</dt>
<dd><strong>Note</strong> even if the input is DateType, the output is TimestampType</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(Column)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvQuarter">
<code class="descname">smvQuarter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvQuarter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvQuarter" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract quarter component from a timestamp</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvQuarter</span><span class="p">())</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">IntegerType. Quarter component as integer (1-based), or null if input column is null</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(Column)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvStrToTimestamp">
<code class="descname">smvStrToTimestamp</code><span class="sig-paren">(</span><em>fmt</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvStrToTimestamp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvStrToTimestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a timestamp from a string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fmt</strong> (<em>string</em>) – the format is the same as the Java <cite>Date</cite> format</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvStrToTimestamp</span><span class="p">(</span><span class="s2">&quot;yyyy-MM-dd&quot;</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">TimestampType. The converted Timestamp</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(Column)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvTimeToIndex">
<code class="descname">smvTimeToIndex</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvTimeToIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvTimeToIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>smvTime helper to convert <cite>smvTime</cite> column to time index integer</p>
<p>Example <cite>smvTime</cite> values (as String): “Q201301”, “M201512”, “D20141201”
Example output 172, 551, 16405 (# of quarters, months, and days from 19700101)</p>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvTimeToLabel">
<code class="descname">smvTimeToLabel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvTimeToLabel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvTimeToLabel" title="Permalink to this definition">¶</a></dt>
<dd><p>smvTime helper to convert <cite>smvTime</cite> column to human readable form</p>
<p>Example <cite>smvTime</cite> values (as String): “Q201301”, “M201512”, “D20141201”
Example output “2013-Q1”, “2015-12”, “2014-12-01”</p>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvTimeToTimestamp">
<code class="descname">smvTimeToTimestamp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvTimeToTimestamp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvTimeToTimestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>smvTime helper to convert <cite>smvTime</cite> column to a timestamp at the beginning of
the given time pireod.</p>
<blockquote>
<div>Example <cite>smvTime</cite> values (as String): “Q201301”, “M201512”, “D20141201”
Example output “2013-01-01 00:00:00.0”, “2015-12-01 00:00:00.0”, “2014-12-01 00:00:00.0”</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvTimeToType">
<code class="descname">smvTimeToType</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvTimeToType"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvTimeToType" title="Permalink to this definition">¶</a></dt>
<dd><p>smvTime helper to convert <cite>smvTime</cite> column to time type string</p>
<p>Example <cite>smvTime</cite> values (as String): “Q201301”, “M201512”, “D20141201”
Example output type “quarter”, “month”, “day”</p>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvTimestampToStr">
<code class="descname">smvTimestampToStr</code><span class="sig-paren">(</span><em>timezone</em>, <em>fmt</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvTimestampToStr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvTimestampToStr" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a string from a timestamp and timezone</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>timezone</strong> (<em>string</em><em> or </em><em>Column</em>) – the timezone follows the rules in
<a class="reference external" href="https://www.joda.org/joda-time/apidocs/org/joda/time/DateTimeZone.html#forID-java.lang.String">https://www.joda.org/joda-time/apidocs/org/joda/time/DateTimeZone.html#forID-java.lang.String</a>-
It can be a string like “America/Los_Angeles” or “+1000”. If it is null, use current system time zone.</li>
<li><strong>fmt</strong> (<em>string</em>) – the format is the same as the Java <cite>Date</cite> format</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;ts&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvTimestampToStr</span><span class="p">(</span><span class="s2">&quot;America/Los_Angeles&quot;</span><span class="p">,</span><span class="s2">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">StringType. The converted String with given format</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(Column)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.ColumnHelper.smvYear">
<code class="descname">smvYear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#ColumnHelper.smvYear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.ColumnHelper.smvYear" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract year component from a timestamp</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;dob&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvYear</span><span class="p">())</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">IntegerType. Year component as integer, or null if input column is null</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(Column)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="smv.helpers.DataFrameHelper">
<em class="property">class </em><code class="descclassname">smv.helpers.</code><code class="descname">DataFrameHelper</code><span class="sig-paren">(</span><em>df</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="smv.helpers.DataFrameHelper.peek">
<code class="descname">peek</code><span class="sig-paren">(</span><em>pos=1</em>, <em>colRegex='.*'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.peek"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.peek" title="Permalink to this definition">¶</a></dt>
<dd><p>Display a DataFrame row in transposed view</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pos</strong> (<em>integer</em>) – the n-th row to display, default as 1</li>
<li><strong>colRegex</strong> (<em>string</em>) – show the columns with name matching the regex, default as “.*”</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(None)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.peekSave">
<code class="descname">peekSave</code><span class="sig-paren">(</span><em>path</em>, <em>pos=1</em>, <em>colRegex='.*'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.peekSave"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.peekSave" title="Permalink to this definition">¶</a></dt>
<dd><p>Write <cite>peek</cite> result to a file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<em>string</em>) – local file name to Write</li>
<li><strong>pos</strong> (<em>integer</em>) – the n-th row to display, default as 1</li>
<li><strong>colRegex</strong> (<em>string</em>) – show the columns with name matching the regex, default as “.*”</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(None)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.selectByLabel">
<code class="descname">selectByLabel</code><span class="sig-paren">(</span><em>labels=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.selectByLabel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.selectByLabel" title="Permalink to this definition">¶</a></dt>
<dd><p>Select columns whose metadata contains the specified labels</p>
<p>If the labels is empty, returns a DataFrame with all the unlabeled columns.
Will throw if there are no columns that satisfy the condition.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>labels</strong> – (list(string)) a list of label strings for the columns to match</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">selectByLabel</span><span class="p">([</span><span class="s2">&quot;tag_1&quot;</span><span class="p">])</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the DataFrame with the selected columns</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvBinHist">
<code class="descname">smvBinHist</code><span class="sig-paren">(</span><em>*colWithBin</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvBinHist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvBinHist" title="Permalink to this definition">¶</a></dt>
<dd><p>Print distributions on numerical columns with applying the specified bin size</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>colWithBin</strong> (<em>*tuple</em>) – each tuple must be of size 2, where the first element is the column name, and the second is the bin size for that column</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvBinHist</span><span class="p">((</span><span class="s2">&quot;col_a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(None)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvConcatHist">
<code class="descname">smvConcatHist</code><span class="sig-paren">(</span><em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvConcatHist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvConcatHist" title="Permalink to this definition">¶</a></dt>
<dd><p>Display EDD histogram of a group of columns (joint distribution)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cols</strong> (<em>*string</em>) – The columns on which to perform EDD histogram</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvConcatHist</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(None)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvCountHist">
<code class="descname">smvCountHist</code><span class="sig-paren">(</span><em>keys</em>, <em>binSize</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvCountHist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvCountHist" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the distribution of the value frequency on specific columns</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>keys</strong> (<em>list</em><em>(</em><em>string</em><em>)</em>) – the column names on which the EDD histogram is performed</li>
<li><strong>binSize</strong> (<em>integer</em>) – the bin size for the histogram</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvCountHist</span><span class="p">([</span><span class="s2">&quot;k&quot;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(None)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvDedupByKey">
<code class="descname">smvDedupByKey</code><span class="sig-paren">(</span><em>*keys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvDedupByKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvDedupByKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove duplicate records from the DataFrame by arbitrarily selecting the first record from a set of records with same primary key or key combo.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>keys</strong> (<em>*string</em><em> or </em><em>*Column</em>) – the column names or Columns on which to apply dedup</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>input DataFrame:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="39%" />
<col width="39%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">product</th>
<th class="head">Company</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>A</td>
<td>C1</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>C</td>
<td>C2</td>
</tr>
<tr class="row-even"><td>2</td>
<td>B</td>
<td>C3</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>B</td>
<td>C4</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvDedupByKey</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>output DataFrame:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="39%" />
<col width="39%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">product</th>
<th class="head">Company</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>A</td>
<td>C1</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>B</td>
<td>C3</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvDedupByKey</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;product&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>output DataFrame:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="39%" />
<col width="39%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">product</th>
<th class="head">Company</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>A</td>
<td>C1</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>C</td>
<td>C2</td>
</tr>
<tr class="row-even"><td>2</td>
<td>B</td>
<td>C3</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a DataFrame without duplicates for the specified keys</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvDedupByKeyWithOrder">
<code class="descname">smvDedupByKeyWithOrder</code><span class="sig-paren">(</span><em>*keys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvDedupByKeyWithOrder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvDedupByKeyWithOrder" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove duplicated records by selecting the first record relative to a given ordering</p>
<p>The order is specified in another set of parentheses, as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">smvDedupByKeyWithOrder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">keys</span><span class="p">)(</span><span class="o">*</span><span class="n">orderCols</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Same as the <cite>smvDedupByKey</cite> method, we use RDD groupBy in the implementation of this method to make sure we can handle large key space.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>keys</strong> (<em>*string</em><em> or </em><em>*Column</em>) – the column names or Columns on which to apply dedup</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>input DataFrame:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="39%" />
<col width="39%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">product</th>
<th class="head">Company</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>A</td>
<td>C1</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>C</td>
<td>C2</td>
</tr>
<tr class="row-even"><td>2</td>
<td>B</td>
<td>C3</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>B</td>
<td>C4</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvDedupByKeyWithOrder</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">))(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;product&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span>
</pre></div>
</div>
<p>output DataFrame:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="39%" />
<col width="39%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">product</th>
<th class="head">Company</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>C</td>
<td>C2</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>B</td>
<td>C3</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a DataFrame without duplicates for the specified keys / order</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvDesc">
<code class="descname">smvDesc</code><span class="sig-paren">(</span><em>*colDescs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvDesc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvDesc" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds column descriptions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>colDescs</strong> (<em>*tuple</em>) – tuples of strings where the first is the column name, and the second is the description to add</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvDesc</span><span class="p">((</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;description of col a&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;description of col b&quot;</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the DataFrame with column descriptions added</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvDescFromDF">
<code class="descname">smvDescFromDF</code><span class="sig-paren">(</span><em>descDF</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvDescFromDF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvDescFromDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds column descriptions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>descDF</strong> (<em>DataFrame</em>) – a companion 2-column desciptionDF that has variable names as column 1 and corresponding variable descriptions as column 2</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvDescFromDF</span><span class="p">(</span><span class="n">desciptionDF</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the DataFrame with column descriptions added</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvDiscoverPK">
<code class="descname">smvDiscoverPK</code><span class="sig-paren">(</span><em>n=10000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvDiscoverPK"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvDiscoverPK" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a column combination which uniquely identifies a row from the data</p>
<p>The resulting output is printed out</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The algorithm only looks for a set of keys which uniquely identifies the row. There could be more key combinations which can also be the primary key.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>n</strong> (<em>integer</em>) – number of rows the PK discovery algorithm will run on, defaults to 10000</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvDiscoverPK</span><span class="p">(</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(None)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvDumpDF">
<code class="descname">smvDumpDF</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvDumpDF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvDumpDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump the schema and data of given df to screen for debugging purposes</p>
<p>Similar to <cite>show()</cite> method of DF from Spark 1.3, although the format is slightly different.  This function’s format is more convenient for us and hence has remained.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvDumpDF</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(None)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvDupeCheck">
<code class="descname">smvDupeCheck</code><span class="sig-paren">(</span><em>keys</em>, <em>n=10000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvDupeCheck"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvDupeCheck" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given list of potential keys, check for duplicated records with the number of duplications and all the columns.</p>
<p>Null values are allowed in the potential keys, so duplication on Null valued keys will also be reported.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>keys</strong> (<em>list</em><em>(</em><em>string</em><em>)</em>) – the key column list which the duplicate check applied</li>
<li><strong>n</strong> (<em>integer</em>) – number of rows from input data for checking duplications, defaults to 10000</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>returns key columns + “_N” + the rest columns for the records with more key duplication records,</dt>
<dd><p class="first last">where “_N” has the count of duplications of the key values of that record</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(DataFrame)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvEdd">
<code class="descname">smvEdd</code><span class="sig-paren">(</span><em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvEdd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvEdd" title="Permalink to this definition">¶</a></dt>
<dd><p>Display EDD summary</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cols</strong> (<em>*string</em>) – column names on which to perform EDD summary</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvEdd</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(None)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvEddCompare">
<code class="descname">smvEddCompare</code><span class="sig-paren">(</span><em>df2</em>, <em>ignoreColName</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvEddCompare"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvEddCompare" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare 2 DFs by comparing their Edd Summary result</p>
<p>The result of the comparison is printed out.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>df2</strong> (<em>DataFrame</em>) – the DataFrame to compare with</li>
<li><strong>ignoreColName</strong> (<em>boolean</em>) – specifies whether to ignore column names, default is false</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvEddCompare</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvEddCompare</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">true</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(None)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvExpandStruct">
<code class="descname">smvExpandStruct</code><span class="sig-paren">(</span><em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvExpandStruct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvExpandStruct" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand structure type column to a group of columns</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cols</strong> (<em>*string</em>) – column names to expand</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<dl class="docutils">
<dt>input DF:</dt>
<dd>[id: string, address: struct&lt;state:string, zip:string, street:string&gt;]</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvExpandStruct</span><span class="p">(</span><span class="s2">&quot;address&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>output DF:</dt>
<dd>[id: string, state: string, zip: string, street: string]</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">DF with expanded columns</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvExportCsv">
<code class="descname">smvExportCsv</code><span class="sig-paren">(</span><em>path</em>, <em>n=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvExportCsv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvExportCsv" title="Permalink to this definition">¶</a></dt>
<dd><p>Export DataFrame to local file system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> (<em>string</em>) – relative path to the app running directory on local file system (instead of HDFS)</li>
<li><strong>n</strong> (<em>integer</em>) – optional. number of records to export. default is all records</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since we have to collect the DF and then call JAVA file operations, the job have to be launched as either local or yar-client mode. Also it is user’s responsibility to make sure that the DF is small enough to fit into local file system.</p>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvExportCsv</span><span class="p">(</span><span class="s2">&quot;./target/python-test-export-csv.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(None)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvFreqHist">
<code class="descname">smvFreqHist</code><span class="sig-paren">(</span><em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvFreqHist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvFreqHist" title="Permalink to this definition">¶</a></dt>
<dd><p>Print EDD histogram with frequency sorting</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cols</strong> (<em>*string</em>) – The columns on which to perform EDD histogram</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvFreqHist</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(None)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvGetDesc">
<code class="descname">smvGetDesc</code><span class="sig-paren">(</span><em>colName=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvGetDesc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvGetDesc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns column description(s)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>colName</strong> (<em>string</em>) – optional column name for which to get the description.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGetDesc</span><span class="p">(</span><span class="s2">&quot;col_a&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGetDesc</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">description string of colName, if specified</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(string)</td>
</tr>
</tbody>
</table>
<p>or:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a list of (colName, description) pairs for all columns</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(list(tuple))</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvGetLabel">
<code class="descname">smvGetLabel</code><span class="sig-paren">(</span><em>colName=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvGetLabel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvGetLabel" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of column label(s)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>colName</strong> (<em>string</em>) – optional column name for which to get the label.</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGetLabel</span><span class="p">(</span><span class="s2">&quot;col_a&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGetLabel</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a list of label strings of colName, if specified</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(list(string))</td>
</tr>
</tbody>
</table>
<p>or:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a list of (colName, list(labels)) pairs for all columns</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(list(tuple))</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvGroupBy">
<code class="descname">smvGroupBy</code><span class="sig-paren">(</span><em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvGroupBy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvGroupBy" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to groupBy, instead of creating GroupedData, create an <cite>SmvGroupedData</cite> object.</p>
<p>See [[org.tresamigos.smv.SmvGroupedDataFunc]] for list of functions that can be applied to the grouped data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cols</strong> (<em>*string</em><em> or </em><em>*Column</em>) – column names or Column objects to group on</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is going away shortly and user will be able to use standard Spark <cite>groupBy</cite> method directly.</p>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGroupBy</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGroupBy</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">grouped data object</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(<a class="reference internal" href="#smv.helpers.SmvGroupedData" title="smv.helpers.SmvGroupedData">SmvGroupedData</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvHashSample">
<code class="descname">smvHashSample</code><span class="sig-paren">(</span><em>key</em>, <em>rate=0.01</em>, <em>seed=23</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvHashSample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvHashSample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample the df according to the hash of a column</p>
<p>MurmurHash3 algorithm is used for generating the hash</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>key</strong> (<em>string</em><em> or </em><em>Column</em>) – column name or Column to sample on</li>
<li><strong>rate</strong> (<em>double</em>) – sample rate in range (0, 1] with a default of 0.01 (1%)</li>
<li><strong>seed</strong> (<em>int</em>) – random generator integer seed with a default of 23</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvHashSample</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">),</span> <span class="n">rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">sampled DF</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvHist">
<code class="descname">smvHist</code><span class="sig-paren">(</span><em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvHist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvHist" title="Permalink to this definition">¶</a></dt>
<dd><p>Display EDD histogram</p>
<p>Each column’s histogram prints separately</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cols</strong> (<em>*string</em>) – The columns on which to perform EDD histogram</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvHist</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(None)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvJoinByKey">
<code class="descname">smvJoinByKey</code><span class="sig-paren">(</span><em>other</em>, <em>keys</em>, <em>joinType</em>, <em>isNullSafe=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvJoinByKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvJoinByKey" title="Permalink to this definition">¶</a></dt>
<dd><p>joins two DataFrames on a key</p>
<p>The Spark <cite>DataFrame</cite> join operation does not handle duplicate key names.
If both left and right side of the join operation contain the same key,
the result <cite>DataFrame</cite> is unusable.</p>
<p>The <cite>smvJoinByKey</cite> method will allow the user to join two <cite>DataFrames</cite> using the same join key.
Post join, only the left side keys will remain. In case of outer-join, the
<cite>coalesce(leftkey, rightkey)</cite> will replace the left key to be kept.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>other</strong> (<em>DataFrame</em>) – the DataFrame to join with</li>
<li><strong>keys</strong> (<em>list</em><em>(</em><em>string</em><em>)</em>) – a list of column names on which to apply the join</li>
<li><strong>joinType</strong> (<em>string</em>) – choose one of [‘inner’, ‘outer’, ‘leftouter’, ‘rightouter’, ‘leftsemi’]</li>
<li><strong>isNullSafe</strong> (<em>boolean</em>) – if true matches null keys between left and right tables and keep in output. Default False.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">smvJoinByKey</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">],</span> <span class="s2">&quot;inner&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_with_null_key</span><span class="o">.</span><span class="n">smvJoinByKey</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;k&quot;</span><span class="p">],</span> <span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">result of the join operation</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvJoinMultipleByKey">
<code class="descname">smvJoinMultipleByKey</code><span class="sig-paren">(</span><em>keys</em>, <em>joinType='inner'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvJoinMultipleByKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvJoinMultipleByKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Create multiple DF join builder</p>
<p>It is used in conjunction with <cite>joinWith</cite> and <cite>doJoin</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>keys</strong> (<em>list</em><em>(</em><em>string</em><em>)</em>) – a list of column names on which to apply the join</li>
<li><strong>joinType</strong> (<em>string</em>) – choose one of [‘inner’, ‘outer’, ‘leftouter’, ‘rightouter’, ‘leftsemi’]</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">joinMultipleByKey</span><span class="p">([</span><span class="s2">&quot;k1&quot;</span><span class="p">,</span> <span class="s2">&quot;k2&quot;</span><span class="p">],</span> <span class="s2">&quot;inner&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">joinWith</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="s2">&quot;_df2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">joinWith</span><span class="p">(</span><span class="n">df3</span><span class="p">,</span> <span class="s2">&quot;_df3&quot;</span><span class="p">,</span> <span class="s2">&quot;leftouter&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">doJoin</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the builder object for the multi join operation</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(<a class="reference internal" href="#smv.helpers.SmvMultiJoin" title="smv.helpers.SmvMultiJoin">SmvMultiJoin</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvLabel">
<code class="descname">smvLabel</code><span class="sig-paren">(</span><em>colNames</em>, <em>labels</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvLabel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvLabel" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds labels to the specified columns</p>
<p>A column may have multiple labels. Adding the same label twice
to a column has the same effect as adding that label once.</p>
<p>For multiple colNames, the same set of labels will be added to all of them.
When colNames is empty, the set of labels will be added to all columns of the df.
labels parameters must be non-empty.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>labels</strong> – (list(string)) a list of label strings to add</li>
<li><strong>colNames</strong> – (list(string)) list of names of columns for which to add labels</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvLabel</span><span class="p">([</span><span class="s2">&quot;col_a&quot;</span><span class="p">,</span> <span class="s2">&quot;col_b&quot;</span><span class="p">,</span> <span class="s2">&quot;col_c&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;tag_1&quot;</span><span class="p">,</span> <span class="s2">&quot;tag_2&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvLabel</span><span class="p">([],</span> <span class="p">[</span><span class="s2">&quot;tag_1&quot;</span><span class="p">,</span> <span class="s2">&quot;tag_2&quot;</span><span class="p">])</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the DataFrame with labels added to the specified columns</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
<p>or:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the DataFrame with labels added to all columns</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvOverlapCheck">
<code class="descname">smvOverlapCheck</code><span class="sig-paren">(</span><em>keyColName</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvOverlapCheck"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvOverlapCheck" title="Permalink to this definition">¶</a></dt>
<dd><p>For a set of DFs, which share the same key column, check the overlap across them</p>
<p>The other DataFrames are specified in another set of parentheses, as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">smvOverlapCheck</span><span class="p">(</span><span class="n">key</span><span class="p">)(</span><span class="o">*</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>keyColName</strong> (<em>string</em>) – the column name for the key column</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">smvOverlapCheck</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)(</span><span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">,</span> <span class="n">df4</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>output DF has 2 columns:</dt>
<dd><ul class="first last simple">
<li>key</li>
<li>flag: a bit-string, e.g. 0110. Each bit represents whether the original DF has this key</li>
</ul>
</dd>
</dl>
<p>It can be used with EDD to summarize on the flag:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df1</span><span class="o">.</span><span class="n">smvOverlapCheck</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">)(</span><span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">)</span><span class="o">.</span><span class="n">smvHist</span><span class="p">(</span><span class="s2">&quot;flag&quot;</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the DataFrame with the key and flag columns</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvPrefixFieldNames">
<code class="descname">smvPrefixFieldNames</code><span class="sig-paren">(</span><em>prefix</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvPrefixFieldNames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvPrefixFieldNames" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a prefix to all column names in the given <cite>DataFrame</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>prefix</strong> (<em>string</em>) – prefix string to be added to all the column names</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvPrefixFieldNames</span><span class="p">(</span><span class="s2">&quot;x_&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Above will add <cite>x_</cite> to the beginning of every column name in the <cite>DataFrame</cite>.
Please note that if the renamed column names over lap with existing columns,
the method will error out.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvRemoveDesc">
<code class="descname">smvRemoveDesc</code><span class="sig-paren">(</span><em>*colNames</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvRemoveDesc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvRemoveDesc" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes description for the given columns from the Dataframe</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>colNames</strong> (<em>*string</em>) – names of columns for which to remove the description</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvRemoveDesc</span><span class="p">(</span><span class="s2">&quot;col_a&quot;</span><span class="p">,</span> <span class="s2">&quot;col_b&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvRemoveDesc</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the DataFrame with column descriptions removed</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
<p>or:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the DataFrae with all column descriptions removed</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvRemoveLabel">
<code class="descname">smvRemoveLabel</code><span class="sig-paren">(</span><em>colNames=None</em>, <em>labels=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvRemoveLabel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvRemoveLabel" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes labels from the specified columns</p>
<p>For multiple colNames, the same set of labels will be removed from all of them.
When colNames is empty, the set of labels will be removed from all columns of the df.
When labels is empty, all labels will be removed from the given columns.</p>
<p>If neither columns nor labels are specified, i.e. both parameter lists are empty,
then all labels are removed from all columns in the data frame, essentially clearing
the label meta data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>labels</strong> – (list(string)) a list of label strings to remove</li>
<li><strong>colNames</strong> – (list(string)) list of names of columns for which to remove labels</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvRemoveLabel</span><span class="p">([</span><span class="s2">&quot;col_a&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;tag_1&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvRemoveLabel</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the DataFrame with specified labels removed from the specified columns</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
<p>or:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the DataFrame with all label meta data cleared</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvRenameField">
<code class="descname">smvRenameField</code><span class="sig-paren">(</span><em>*namePairs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvRenameField"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvRenameField" title="Permalink to this definition">¶</a></dt>
<dd><p>Rename one or more fields of a <cite>DataFrame</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>namePairs</strong> (<em>*tuple</em>) – tuples of strings where the first is the source column name, and the second is the target column name</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvRenameField</span><span class="p">((</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;aa&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;cc&quot;</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the DataFrame with renamed fields</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvSelectMinus">
<code class="descname">smvSelectMinus</code><span class="sig-paren">(</span><em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvSelectMinus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvSelectMinus" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove one or more columns from current DataFrame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cols</strong> (<em>*string</em><em> or </em><em>*Column</em>) – column names or Columns to remove from the DataFrame</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvSelectMinus</span><span class="p">(</span><span class="s2">&quot;col1&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvSelectMinus</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;col1&quot;</span><span class="p">),</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;col2&quot;</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the resulting DataFrame after removal of columns</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvSelectPlus">
<code class="descname">smvSelectPlus</code><span class="sig-paren">(</span><em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvSelectPlus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvSelectPlus" title="Permalink to this definition">¶</a></dt>
<dd><p>Selects all the current columns in current DataFrame plus the supplied expressions</p>
<p>The new columns are added to the end of the current column list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cols</strong> (<em>*Column</em>) – expressions to add to the DataFrame</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvSelectPlus</span><span class="p">((</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;amt&quot;</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the resulting DataFrame after removal of columns</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvSkewJoinByKey">
<code class="descname">smvSkewJoinByKey</code><span class="sig-paren">(</span><em>other</em>, <em>joinType</em>, <em>skewVals</em>, <em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvSkewJoinByKey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvSkewJoinByKey" title="Permalink to this definition">¶</a></dt>
<dd><p>Join that leverages broadcast (map-side) join of rows with skewed (high-frequency) values</p>
<p>Rows keyed by skewed values are joined via broadcast join while remaining
rows are joined without broadcast join. Occurrences of skewVals in df2 should be
infrequent enough that the filtered table is small enough for a broadcast join.
result is the union of the join results.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>other</strong> (<em>DataFrame</em>) – DataFrame to join with</li>
<li><strong>joinType</strong> (<em>str</em>) – name of type of join (e.g. “inner”)</li>
<li><strong>skewVals</strong> (<em>list</em><em>(</em><em>object</em><em>)</em>) – list of skewed values</li>
<li><strong>key</strong> (<em>str</em>) – key on which to join (also the Column with the skewed values)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvSkewJoinByKey</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;cid&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>will broadcast join the rows of df1 and df2 where col(“cid”) == “4”
and join the remaining rows of df1 and df2 without broadcast join.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the result of the join operation</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvUnion">
<code class="descname">smvUnion</code><span class="sig-paren">(</span><em>*dfothers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvUnion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvUnion" title="Permalink to this definition">¶</a></dt>
<dd><p>Unions DataFrames with different number of columns by column name and schema</p>
<p>Spark unionAll ignores column names &amp; schema, and can only be performed on tables with the same number of columns.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dfOthers</strong> (<em>*DataFrame</em>) – the dataframes to union with</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvUnion</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the union of all specified DataFrames</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvUnpivot">
<code class="descname">smvUnpivot</code><span class="sig-paren">(</span><em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvUnpivot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvUnpivot" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpivot the selected columns</p>
<p>Given a set of records with value columns, turns the value columns into value rows.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cols</strong> (<em>*string</em>) – the names of the columns to unpivot</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>input DF:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="23%" />
<col width="23%" />
<col width="23%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">X</th>
<th class="head">Y</th>
<th class="head">Z</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>A</td>
<td>B</td>
<td>C</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>D</td>
<td>E</td>
<td>F</td>
</tr>
<tr class="row-even"><td>3</td>
<td>G</td>
<td>H</td>
<td>I</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvUnpivot</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Z&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>output DF:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="42%" />
<col width="37%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">column</th>
<th class="head">value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>X</td>
<td>A</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>Y</td>
<td>B</td>
</tr>
<tr class="row-even"><td>1</td>
<td>Z</td>
<td>C</td>
</tr>
<tr class="row-odd"><td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="row-even"><td>3</td>
<td>Y</td>
<td>H</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>Z</td>
<td>I</td>
</tr>
</tbody>
</table>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the unpivoted DataFrame</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvUnpivotRegex">
<code class="descname">smvUnpivotRegex</code><span class="sig-paren">(</span><em>cols</em>, <em>colNameFn</em>, <em>indexColName</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvUnpivotRegex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvUnpivotRegex" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpivot the selected columns using the specified regex</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cols</strong> (<em>*string</em>) – the names of the columns to unpivot</li>
<li><strong>colNameFn</strong> (<em>string</em>) – a regex representing the function to be applied when unpivoting</li>
<li><strong>indexColName</strong> (<em>string</em>) – the name of the index column to be created</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>input DF:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="22%" />
<col width="22%" />
<col width="22%" />
<col width="22%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">A_1</th>
<th class="head">A_2</th>
<th class="head">B_1</th>
<th class="head">B_2</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>1_a_1</td>
<td>1_a_2</td>
<td>1_b_1</td>
<td>1_b_2</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>2_a_1</td>
<td>2_a_2</td>
<td>2_b_1</td>
<td>2_b_2</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvUnpivotRegex</span><span class="p">(</span> <span class="p">[</span><span class="s2">&quot;A_1&quot;</span><span class="p">,</span> <span class="s2">&quot;A_2&quot;</span><span class="p">,</span> <span class="s2">&quot;B_1&quot;</span><span class="p">,</span> <span class="s2">&quot;B_2&quot;</span><span class="p">],</span> <span class="s2">&quot;(.*)_(.*)&quot;</span><span class="p">,</span> <span class="s2">&quot;index&quot;</span> <span class="p">)</span>
</pre></div>
</div>
<p>output DF:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="28%" />
<col width="28%" />
<col width="28%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">index</th>
<th class="head">A</th>
<th class="head">B</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>1</td>
<td>1_a_1</td>
<td>1_b_1</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>2</td>
<td>1_a_2</td>
<td>1_b_2</td>
</tr>
<tr class="row-even"><td>2</td>
<td>1</td>
<td>2_a_1</td>
<td>2_b_1</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>2</td>
<td>2_a_2</td>
<td>2_b_2</td>
</tr>
</tbody>
</table>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the unpivoted DataFrame</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.smvWithLabel">
<code class="descname">smvWithLabel</code><span class="sig-paren">(</span><em>labels=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.smvWithLabel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.smvWithLabel" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all column names in the data frame that contain all the specified labels</p>
<p>If the labels is empty, returns all unlabeled columns in the data frame.
Will throw if there are no columns that satisfy the condition.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>labels</strong> – (list(string)) a list of label strings for the columns to match</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvWithLabel</span><span class="p">([</span><span class="s2">&quot;tag_1&quot;</span><span class="p">,</span> <span class="s2">&quot;tag_2&quot;</span><span class="p">])</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a list of column name strings that match the specified labels</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(list(string))</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.DataFrameHelper.topNValsByFreq">
<code class="descname">topNValsByFreq</code><span class="sig-paren">(</span><em>n</em>, <em>col</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#DataFrameHelper.topNValsByFreq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.DataFrameHelper.topNValsByFreq" title="Permalink to this definition">¶</a></dt>
<dd><p>Get top N most frequent values in Column col</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n</strong> (<em>int</em>) – maximum number of values</li>
<li><strong>col</strong> (<em>Column</em>) – which column to get values from</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">topNValsByFreq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;cid&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>will return the single most frequent value in the cid column</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">most frequent values (type depends on schema)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(list(object))</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="smv.helpers.SmvGroupedData">
<em class="property">class </em><code class="descclassname">smv.helpers.</code><code class="descname">SmvGroupedData</code><span class="sig-paren">(</span><em>df</em>, <em>keys</em>, <em>sgd</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvGroupedData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvGroupedData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The result of running <cite>smvGroupBy</cite> on a DataFrame. Implements special SMV aggregations.</p>
<dl class="method">
<dt id="smv.helpers.SmvGroupedData.smvDecile">
<code class="descname">smvDecile</code><span class="sig-paren">(</span><em>value_cols</em>, <em>ignoreNull=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvGroupedData.smvDecile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvGroupedData.smvDecile" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute deciles of some columns on a grouped data</p>
<p>Simply an alias to <cite>smvQuantile(value_cols, 10, ignoreNull)</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>value_cols</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – columns to calculate deciles on</li>
<li><strong>ignoreNull</strong> (<em>boolean</em>) – if true, null values’s percent ranks will be nulls, otherwise,
as Spark sort considers null smaller than any value, nulls percent ranks will be
zeros. Default true.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.SmvGroupedData.smvFillNullWithPrevValue">
<code class="descname">smvFillNullWithPrevValue</code><span class="sig-paren">(</span><em>*orderCols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvGroupedData.smvFillNullWithPrevValue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvGroupedData.smvFillNullWithPrevValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill in Null values with “previous” value according to an ordering</p>
<p class="rubric">Examples</p>
<p>Given DataFrame df representing the table</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">K</th>
<th class="head">T</th>
<th class="head">V</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>a</td>
<td>1</td>
<td>null</td>
</tr>
<tr class="row-odd"><td>a</td>
<td>2</td>
<td>a</td>
</tr>
<tr class="row-even"><td>a</td>
<td>3</td>
<td>b</td>
</tr>
<tr class="row-odd"><td>a</td>
<td>4</td>
<td>null</td>
</tr>
</tbody>
</table>
<p>we can use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; df.smvGroupBy(&quot;K&quot;).smvFillNullWithPrevValue($&quot;T&quot;.asc)(&quot;V&quot;)
</pre></div>
</div>
<p>to produce the result</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">K</th>
<th class="head">T</th>
<th class="head">V</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>a</td>
<td>1</td>
<td>null</td>
</tr>
<tr class="row-odd"><td>a</td>
<td>2</td>
<td>a</td>
</tr>
<tr class="row-even"><td>a</td>
<td>3</td>
<td>b</td>
</tr>
<tr class="row-odd"><td>a</td>
<td>4</td>
<td>b</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">result of fill nulls with previous value</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(Dataframe)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.SmvGroupedData.smvPercentRank">
<code class="descname">smvPercentRank</code><span class="sig-paren">(</span><em>value_cols</em>, <em>ignoreNull=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvGroupedData.smvPercentRank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvGroupedData.smvPercentRank" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the percent rank of a sequence of columns within a group in a given DataFrame.</p>
<p>Used Spark’s <cite>percentRank</cite> window function. The precent rank is defined as
<cite>R/(N-1)</cite>, where <cite>R</cite> is the base 0 rank, and <cite>N</cite> is the population size. Under
this definition, min value (R=0) has percent rank <cite>0.0</cite>, and max value has percent
rank <cite>1.0</cite>.</p>
<p>For each column for which the percent rank is computed (e.g. “v”), an additional column is
added to the output, <cite>v_pctrnk</cite></p>
<p>All other columns in the input are untouched and propagated to the output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>value_cols</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – columns to calculate percentRank on</li>
<li><strong>ignoreNull</strong> (<em>boolean</em>) – if true, null values’s percent ranks will be nulls, otherwise,
as Spark sort considers null smaller than any value, nulls percent ranks will be
zeros. Default true.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGroupBy</span><span class="p">(</span><span class="s1">&#39;g, &#39;</span><span class="n">g2</span><span class="p">)</span><span class="o">.</span><span class="n">smvPercentRank</span><span class="p">([</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span> <span class="s2">&quot;v2&quot;</span><span class="p">,</span> <span class="s2">&quot;v3&quot;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.SmvGroupedData.smvPivot">
<code class="descname">smvPivot</code><span class="sig-paren">(</span><em>pivotCols</em>, <em>valueCols</em>, <em>baseOutput</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvGroupedData.smvPivot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvGroupedData.smvPivot" title="Permalink to this definition">¶</a></dt>
<dd><p>smvPivot adds the pivoted columns without additional aggregation. In other words
N records in, N records out</p>
<p>SmvPivot for Pivot Operations:</p>
<p>Pivot Operation on DataFrame that transforms multiple rows per key into a columns so
they can be aggregated to a single row for a given key while preserving all the data
variance.</p>
<p class="rubric">Example</p>
<p>For input data below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="25%" />
<col width="32%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">month</th>
<th class="head">product</th>
<th class="head">count</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>5/14</td>
<td>A</td>
<td>100</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>6/14</td>
<td>B</td>
<td>200</td>
</tr>
<tr class="row-even"><td>1</td>
<td>5/14</td>
<td>B</td>
<td>300</td>
</tr>
</tbody>
</table>
<p>We would like to generate a data set to be ready for aggregations.
The desired output is:</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="23%" />
<col width="23%" />
<col width="23%" />
<col width="23%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">count_5_14_A</th>
<th class="head">count_5_14_B</th>
<th class="head">count_6_14_A</th>
<th class="head">count_6_14_B</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>100</td>
<td>NULL</td>
<td>NULL</td>
<td>NULL</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>NULL</td>
<td>NULL</td>
<td>NULL</td>
<td>200</td>
</tr>
<tr class="row-even"><td>1</td>
<td>NULL</td>
<td>300</td>
<td>NULL</td>
<td>NULL</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>The raw input is divided into three parts.</dt>
<dd><ol class="first last arabic simple">
<li><dl class="first docutils">
<dt>key column: part of the primary key that is preserved in the output.</dt>
<dd>That would be the <cite>id</cite> column in the above example.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>pivot columns: the columns whose row values will become the new column names.</dt>
<dd>The cross product of all unique values for <em>each</em> column is used to generate
the output column names.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>value column: the value that will be copied/aggregated to corresponding output</dt>
<dd>column. <cite>count</cite> in our example.</dd>
</dl>
</li>
</ol>
</dd>
</dl>
<p>Example code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGroupBy</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvPivot</span><span class="p">([[</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;product&quot;</span><span class="p">]],</span> <span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;5_14_A&quot;</span><span class="p">,</span> <span class="s2">&quot;5_14_B&quot;</span><span class="p">,</span> <span class="s2">&quot;6_14_A&quot;</span><span class="p">,</span> <span class="s2">&quot;6_14_B&quot;</span><span class="p">])</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pivotCols</strong> (<em>list</em><em>(</em><em>list</em><em>(</em><em>str</em><em>)</em><em>)</em>) – specify the pivot columns, on above example, it is
[[‘month, ‘product]]. If [[‘month’], [‘month’, ‘product’]] is
used, the output columns will have “count_5_14” and “count_6_14” as
addition to the example.</li>
<li><strong>valueCols</strong> (<em>list</em><em>(</em><em>string</em><em>)</em>) – names of value columns which will be prepared for
aggregation</li>
<li><strong>baseOutput</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – expected names of the pivoted column
In above example, it is [“5_14_A”, “5_14_B”, “6_14_A”, “6_14_B”].
The user is required to supply the list of expected pivot column output names to avoid
and extra action on the input DataFrame just to extract the possible pivot columns.
If an empty sequence is provided, the base output columns will be extracted from
values in the pivot columns (will cause an action on the entire DataFrame!)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">result of pivot operation</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(DataFrame)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.SmvGroupedData.smvPivotCoalesce">
<code class="descname">smvPivotCoalesce</code><span class="sig-paren">(</span><em>pivotCols</em>, <em>valueCols</em>, <em>baseOutput</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvGroupedData.smvPivotCoalesce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvGroupedData.smvPivotCoalesce" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform SmvPivot, then coalesce the output
Please refer smvPivot’s document for context and details of the SmvPivot operation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pivotCols</strong> (<em>list</em><em>(</em><em>list</em><em>(</em><em>str</em><em>)</em><em>)</em>) – list of lists of column names to pivot</li>
<li><strong>valueCols</strong> (<em>list</em><em>(</em><em>string</em><em>)</em>) – names of value columns to coalesce</li>
<li><strong>baseOutput</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – expected names pivoted column</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>For example, given a DataFrame df that represents the table</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="30%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">k</th>
<th class="head">p</th>
<th class="head">v</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>a</td>
<td>c</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>a</td>
<td>d</td>
<td>2</td>
</tr>
<tr class="row-even"><td>a</td>
<td>e</td>
<td>null</td>
</tr>
<tr class="row-odd"><td>a</td>
<td>f</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>we can use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGroupBy</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvPivotCoalesce</span><span class="p">([[</span><span class="s1">&#39;p&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>to produce the following output</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="19%" />
<col width="19%" />
<col width="25%" />
<col width="19%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">k</th>
<th class="head">v_c</th>
<th class="head">v_d</th>
<th class="head">v_e</th>
<th class="head">v_f</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>a</td>
<td>1</td>
<td>2</td>
<td>null</td>
<td>5</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">result of pivot coalesce</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(Dataframe)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.SmvGroupedData.smvPivotSum">
<code class="descname">smvPivotSum</code><span class="sig-paren">(</span><em>pivotCols</em>, <em>valueCols</em>, <em>baseOutput</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvGroupedData.smvPivotSum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvGroupedData.smvPivotSum" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform SmvPivot, then sum the results.
Please refer smvPivot’s document for context and details of the SmvPivot operation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pivotCols</strong> (<em>list</em><em>(</em><em>list</em><em>(</em><em>str</em><em>)</em><em>)</em>) – list of lists of column names to pivot</li>
<li><strong>valueCols</strong> (<em>list</em><em>(</em><em>string</em><em>)</em>) – names of value columns to sum</li>
<li><strong>baseOutput</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – expected names pivoted column</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>For example, given a DataFrame df that represents the table</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="25%" />
<col width="32%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">month</th>
<th class="head">product</th>
<th class="head">count</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>5/14</td>
<td>A</td>
<td>100</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>6/14</td>
<td>B</td>
<td>200</td>
</tr>
<tr class="row-even"><td>1</td>
<td>5/14</td>
<td>B</td>
<td>300</td>
</tr>
</tbody>
</table>
<p>we can use</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGroupBy</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvPivotSum</span><span class="p">([[</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="s2">&quot;product&quot;</span><span class="p">]],</span> <span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;5_14_A&quot;</span><span class="p">,</span> <span class="s2">&quot;5_14_B&quot;</span><span class="p">,</span> <span class="s2">&quot;6_14_A&quot;</span><span class="p">,</span> <span class="s2">&quot;6_14_B&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>to produce the following output</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="23%" />
<col width="23%" />
<col width="23%" />
<col width="23%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">id</th>
<th class="head">count_5_14_A</th>
<th class="head">count_5_14_B</th>
<th class="head">count_6_14_A</th>
<th class="head">count_6_14_B</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>100</td>
<td>300</td>
<td>NULL</td>
<td>200</td>
</tr>
</tbody>
</table>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">result of pivot sum</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.SmvGroupedData.smvQuantile">
<code class="descname">smvQuantile</code><span class="sig-paren">(</span><em>value_cols</em>, <em>bin_num</em>, <em>ignoreNull=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvGroupedData.smvQuantile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvGroupedData.smvQuantile" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the quantile bin numbers within a group in a given DataFrame.</p>
<p>Estimate quantiles and quantile groups given a data with unknown distribution is
quite arbitrary. There are multiple ‘definitions’ used in different softwares. Please refer
<a class="reference external" href="https://en.wikipedia.org/wiki/Quantile#Estimating_quantiles_from_a_sample">https://en.wikipedia.org/wiki/Quantile#Estimating_quantiles_from_a_sample</a>
for details.</p>
<p><cite>smvQuantile</cite> calculated from Spark’s <cite>percentRank</cite>. The algorithm is equavalent to the
one labled as <cite>R-7, Excel, SciPy-(1,1), Maple-6</cite> in above wikipedia page. Please note it
is slight different from SAS’s default algorithm (labled as SAS-5).</p>
<p>Returned quantile bin numbers are 1 based. For example when <cite>bin_num=10</cite>, returned values are
integers from 1 to 10, inclusively.</p>
<p>For each column for which the quantile is computed (e.g. “v”), an additional column is added to
the output, “v_quantile”.</p>
<p>All other columns in the input are untouched and propagated to the output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>value_cols</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – columns to calculate quantiles on</li>
<li><strong>bin_num</strong> (<em>int</em>) – number of quantiles, e.g. 4 for quartile, 10 for decile</li>
<li><strong>ignoreNull</strong> (<em>boolean</em>) – if true, null values’s percent ranks will be nulls, otherwise,
as Spark sort considers null smaller than any value, nulls percent ranks will be
zeros. Default true.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGroupBy</span><span class="p">(</span><span class="s1">&#39;g, &#39;</span><span class="n">g2</span><span class="p">)</span><span class="o">.</span><span class="n">smvQuantile</span><span class="p">([</span><span class="s2">&quot;v&quot;</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.SmvGroupedData.smvRePartition">
<code class="descname">smvRePartition</code><span class="sig-paren">(</span><em>numParts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvGroupedData.smvRePartition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvGroupedData.smvRePartition" title="Permalink to this definition">¶</a></dt>
<dd><p>Repartition SmvGroupedData using specified partitioner on the keys. A
HashPartitioner with the specified number of partitions will be used.</p>
<p>This method is used in the cases that the key-space is very large. In the
current Spark DF’s groupBy method, the entire key-space is actually loaded
into executor’s memory, which is very dangerous when the key space is big.
The regular DF’s repartition function doesn’t solve this issue since a random
repartition will not guaranteed to reduce the key-space on each executor.
In that case we need to use this function to linearly reduce the key-space.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGroupBy</span><span class="p">(</span><span class="s2">&quot;k1&quot;</span><span class="p">,</span> <span class="s2">&quot;k2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvRePartition</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="s2">&quot;v&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.SmvGroupedData.smvTimePanelAgg">
<code class="descname">smvTimePanelAgg</code><span class="sig-paren">(</span><em>time_col</em>, <em>start</em>, <em>end</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvGroupedData.smvTimePanelAgg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvGroupedData.smvTimePanelAgg" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply aggregation on given keys and specified time panel period</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>time_col</strong> (<em>str</em>) – the column name in the data as the event timestamp</li>
<li><strong>start</strong> (<em>panel.PartialTime</em>) – could be Day, Month, Week, Quarter, refer the panel
package for details</li>
<li><strong>end</strong> (<em>panel.PartialTime</em>) – should be the same time type as the “start”</li>
<li><strong>addMissingTimeWithNull</strong> (<em>default true</em>) – fill null records</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Both <cite>start</cite> and <cite>end</cite> PartialTime are inclusive.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGroupBy</span><span class="p">(</span><span class="s2">&quot;K&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvTimePanelAgg</span><span class="p">(</span><span class="s2">&quot;TS&quot;</span><span class="p">,</span> <span class="n">Week</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Week</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">))(</span>
<span class="go">        sum(&quot;V&quot;).alias(&quot;V&quot;)</span>
<span class="go">    )</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>a result data frame with keys, and a column with name <cite>smvTime</cite>, and</dt>
<dd>aggregated values. Refer the panel package for the potential forms of different
PartialTimes</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
<p>When addMissingTimeWithNull is true, the aggregation should be always on the variables
instead of on literals (should NOT be count(lit(1))).</p>
<p>Example with on data:</p>
<blockquote>
<div><p>Given DataFrame df as</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="57%" />
<col width="29%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">K</th>
<th class="head">TS</th>
<th class="head">V</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>2012-01-01</td>
<td>1.5</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>2012-03-01</td>
<td>4.5</td>
</tr>
<tr class="row-even"><td>1</td>
<td>2012-07-01</td>
<td>7.5</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>2012-05-01</td>
<td>2.45</td>
</tr>
</tbody>
</table>
<p>after applying</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">smv.panel</span> <span class="k">as</span> <span class="nn">P</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGroupBy</span><span class="p">(</span><span class="s2">&quot;K&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvTimePanelAgg</span><span class="p">(</span><span class="s2">&quot;TS&quot;</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">Quarter</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">P</span><span class="o">.</span><span class="n">Quarter</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">2</span><span class="p">))(</span>
<span class="go">        sum(&quot;V&quot;).alias(&quot;V&quot;)</span>
<span class="go">    )</span>
</pre></div>
</div>
<p>the result is</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="50%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">K</th>
<th class="head">smvTime</th>
<th class="head">V</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>Q201201</td>
<td>6.0</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>Q201202</td>
<td>2.45</td>
</tr>
</tbody>
</table>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.SmvGroupedData.smvTopNRecs">
<code class="descname">smvTopNRecs</code><span class="sig-paren">(</span><em>maxElems</em>, <em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvGroupedData.smvTopNRecs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvGroupedData.smvTopNRecs" title="Permalink to this definition">¶</a></dt>
<dd><p>For each group, return the top N records according to a given ordering</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGroupBy</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvTopNRecs</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;amt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span>
</pre></div>
</div>
<p>This will keep the 3 largest amt records for each id</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>maxElems</strong> (<em>int</em>) – maximum number of records per group</li>
<li><strong>cols</strong> (<em>*str</em>) – columns defining the ordering</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">result of taking top records from groups</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(DataFrame)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.SmvGroupedData.smvWithTimePanel">
<code class="descname">smvWithTimePanel</code><span class="sig-paren">(</span><em>time_col</em>, <em>start</em>, <em>end</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvGroupedData.smvWithTimePanel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvGroupedData.smvWithTimePanel" title="Permalink to this definition">¶</a></dt>
<dd><p>Adding a specified time panel period to the DF</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>time_col</strong> (<em>str</em>) – the column name in the data as the event timestamp</li>
<li><strong>start</strong> (<em>panel.PartialTime</em>) – could be Day, Month, Week, Quarter, refer
the panel package for details</li>
<li><strong>end</strong> (<em>panel.PartialTime</em>) – should be the same time type as the “start”</li>
<li><strong>addMissingTimeWithNull</strong> (<em>boolean</em>) – Default True. when some PartialTime
is missing whether to fill null records</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>a result data frame with keys, and a column with name <cite>smvTime</cite>, and</dt>
<dd><p class="first last">other input columns. Refer the panel package for the potential forms of
different PartialTimes.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(DataFrame)</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since <cite>TimePanel</cite> defines a period of time, if for some group in the data
there are missing Months (or Quarters), when addMissingTimeWithNull is true,
this function will add records with non-null keys and
all possible <cite>smvTime</cite> columns with all other columns null-valued.</p>
</div>
<p class="rubric">Example</p>
<p>Given DataFrame df as</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="57%" />
<col width="29%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">K</th>
<th class="head">TS</th>
<th class="head">V</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>2014-01-01</td>
<td>1.2</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>2014-03-01</td>
<td>4.5</td>
</tr>
<tr class="row-even"><td>1</td>
<td>2014-03-25</td>
<td>10.3</td>
</tr>
</tbody>
</table>
<p>after applying</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">smv.panel</span> <span class="k">as</span> <span class="nn">P</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">smvGroupBy</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">smvWithTimePanel</span><span class="p">(</span><span class="s2">&quot;TS&quot;</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">Month</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">P</span><span class="o">.</span><span class="n">Month</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<p>the result is</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="40%" />
<col width="20%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">K</th>
<th class="head">TS</th>
<th class="head">V</th>
<th class="head">smvTime</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>2014-01-01</td>
<td>1.2</td>
<td>M201401</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>2014-03-01</td>
<td>4.5</td>
<td>M201403</td>
</tr>
<tr class="row-even"><td>1</td>
<td>2014-03-25</td>
<td>10.3</td>
<td>M201403</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>None</td>
<td>None</td>
<td>M201401</td>
</tr>
<tr class="row-even"><td>1</td>
<td>None</td>
<td>None</td>
<td>M201402</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>None</td>
<td>None</td>
<td>M201403</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="smv.helpers.SmvMultiJoin">
<em class="property">class </em><code class="descclassname">smv.helpers.</code><code class="descname">SmvMultiJoin</code><span class="sig-paren">(</span><em>sqlContext</em>, <em>mj</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvMultiJoin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvMultiJoin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Wrapper around Scala’s SmvMultiJoin</p>
<dl class="method">
<dt id="smv.helpers.SmvMultiJoin.doJoin">
<code class="descname">doJoin</code><span class="sig-paren">(</span><em>dropextra=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvMultiJoin.doJoin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvMultiJoin.doJoin" title="Permalink to this definition">¶</a></dt>
<dd><p>Trigger the join operation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dropExtra</strong> (<em>boolean</em>) – default false, which will keep all duplicated name columns with the postfix.
when true, the duplicated columns will be dropped</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">joindf</span><span class="o">.</span><span class="n">doJoin</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">result of executing the join operation</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.helpers.SmvMultiJoin.joinWith">
<code class="descname">joinWith</code><span class="sig-paren">(</span><em>df</em>, <em>postfix</em>, <em>jointype=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#SmvMultiJoin.joinWith"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.SmvMultiJoin.joinWith" title="Permalink to this definition">¶</a></dt>
<dd><p>Append SmvMultiJoin Chain</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>df</strong> (<em>DataFrame</em>) – the DataFrame to join with</li>
<li><strong>postfix</strong> (<em>string</em>) – postfix to use when renaming join columns</li>
<li><strong>jointype</strong> (<em>string</em>) – optional jointype. if not specified, <cite>conf.defaultJoinType</cite> is used.  choose one of [‘inner’, ‘outer’, ‘leftouter’, ‘rightouter’, ‘leftsemi’]</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">joindf</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">smvJoinMultipleByKey</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="s1">&#39;inner&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">joinWith</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="s1">&#39;_df2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">joinWith</span><span class="p">(</span><span class="n">df3</span><span class="p">,</span> <span class="s1">&#39;_df3&#39;</span><span class="p">,</span> <span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">formula of the join. need to call <cite>doJoin()</cite> on it to execute</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(<a class="reference internal" href="#smv.helpers.SmvMultiJoin" title="smv.helpers.SmvMultiJoin">SmvMultiJoin</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="smv.helpers.init_helpers">
<code class="descclassname">smv.helpers.</code><code class="descname">init_helpers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/helpers.html#init_helpers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.helpers.init_helpers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-smv.matcher">
<span id="smv-matcher-module"></span><h2>smv.matcher module<a class="headerlink" href="#module-smv.matcher" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="smv.matcher.ExactLogic">
<code class="descclassname">smv.matcher.</code><code class="descname">ExactLogic</code><span class="sig-paren">(</span><em>colName</em>, <em>expr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/matcher.html#ExactLogic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.matcher.ExactLogic" title="Permalink to this definition">¶</a></dt>
<dd><p>Level match with exact logic</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>colName</strong> (<em>string</em>) – level name used in the output DF</li>
<li><strong>expr</strong> (<em>Column</em>) – match logic colName</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ExactLogic</span><span class="p">(</span><span class="s2">&quot;First_Name_Match&quot;</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;first_name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;_first_name&quot;</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(ExactLogic)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.matcher.ExactMatchPreFilter">
<code class="descclassname">smv.matcher.</code><code class="descname">ExactMatchPreFilter</code><span class="sig-paren">(</span><em>colName</em>, <em>expr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/matcher.html#ExactMatchPreFilter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.matcher.ExactMatchPreFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify the top-level exact match</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>colName</strong> (<em>string</em>) – level name used in the output DF</li>
<li><strong>expr</strong> (<em>Column</em>) – match logic condition Column</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ExactMatchPreFilter</span><span class="p">(</span><span class="s2">&quot;Full_Name_Match&quot;</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;full_name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;_full_name&quot;</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(ExactMatchPreFilter)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.matcher.FuzzyLogic">
<code class="descclassname">smv.matcher.</code><code class="descname">FuzzyLogic</code><span class="sig-paren">(</span><em>colName</em>, <em>predicate</em>, <em>valueExpr</em>, <em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/matcher.html#FuzzyLogic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.matcher.FuzzyLogic" title="Permalink to this definition">¶</a></dt>
<dd><p>Level match with fuzzy logic</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>colName</strong> (<em>string</em>) – level name used in the output DF</li>
<li><strong>predicate</strong> (<em>Column</em>) – a condition column, no match if this condition evaluates as false</li>
<li><strong>valueExpr</strong> (<em>Column</em>) – a value column, which typically return a score. Higher score means higher chance of matching</li>
<li><strong>threshold</strong> (<em>float</em>) – No match if the evaluated <cite>valueExpr</cite> &lt; threshold</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FuzzyLogic</span><span class="p">(</span><span class="s2">&quot;Levenshtein_City&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span> <span class="n">normlevenshtein</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;city&quot;</span><span class="p">),</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;_city&quot;</span><span class="p">)),</span> <span class="mf">0.9</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(FuzzyLogic)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.matcher.GroupCondition">
<code class="descclassname">smv.matcher.</code><code class="descname">GroupCondition</code><span class="sig-paren">(</span><em>expr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/matcher.html#GroupCondition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.matcher.GroupCondition" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify the shared matching condition of all the levels (except the top-level exact match)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>expr</strong> (<em>Column</em>) – shared matching condition</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><cite>expr</cite> should be in “left == right” form so that it can really optimize the process by reducing searching space</p>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">GroupCondition</span><span class="p">(</span><span class="n">soundex</span><span class="p">(</span><span class="s2">&quot;first_name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">soundex</span><span class="p">(</span><span class="s2">&quot;_first_name&quot;</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(GroupCondition)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.matcher.NoOpGroupCondition">
<code class="descclassname">smv.matcher.</code><code class="descname">NoOpGroupCondition</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/matcher.html#NoOpGroupCondition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.matcher.NoOpGroupCondition" title="Permalink to this definition">¶</a></dt>
<dd><p>Always returns None</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(None)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.matcher.NoOpPreFilter">
<code class="descclassname">smv.matcher.</code><code class="descname">NoOpPreFilter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/matcher.html#NoOpPreFilter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.matcher.NoOpPreFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Always returns None</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(None)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="smv.matcher.SmvEntityMatcher">
<em class="property">class </em><code class="descclassname">smv.matcher.</code><code class="descname">SmvEntityMatcher</code><span class="sig-paren">(</span><em>leftId</em>, <em>rightId</em>, <em>exactMatchFilter</em>, <em>groupCondition</em>, <em>levelLogics</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/matcher.html#SmvEntityMatcher"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.matcher.SmvEntityMatcher" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Perform multiple level entity matching with exact and/or fuzzy logic</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>leftId</strong> (<em>string</em>) – id column name of left DF (df1)</li>
<li><strong>rightId</strong> (<em>string</em>) – id column name of right DF (df2)</li>
<li><strong>exactMatchFilter</strong> (<em>ExactMatchPreFilter</em>) – exact match condition, if records matched no further tests will be performed</li>
<li><strong>groupCondition</strong> (<em>GroupCondition</em>) – for exact match leftovers, a deterministic condition to narrow down the search space</li>
<li><strong>levelLogics</strong> (<em>list</em><em>(</em><em>ExactLogic</em><em> or </em><em>FuzzyLogic</em><em>)</em>) – A list of level match conditions (always weaker than exactMatchFilter), all of them will be tested</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SmvEntityMatcher</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;_id&quot;</span><span class="p">,</span>
    <span class="n">ExactMatchPreFilter</span><span class="p">(</span><span class="s2">&quot;Full_Name_Match&quot;</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;full_name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;_full_name&quot;</span><span class="p">)),</span>
    <span class="n">GroupCondition</span><span class="p">(</span><span class="n">soundex</span><span class="p">(</span><span class="s2">&quot;first_name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">soundex</span><span class="p">(</span><span class="s2">&quot;_first_name&quot;</span><span class="p">)),</span>
    <span class="p">[</span>
        <span class="n">ExactLogic</span><span class="p">(</span><span class="s2">&quot;First_Name_Match&quot;</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;first_name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;_first_name&quot;</span><span class="p">)),</span>
        <span class="n">FuzzyLogic</span><span class="p">(</span><span class="s2">&quot;Levenshtein_City&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span> <span class="n">normlevenshtein</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;city&quot;</span><span class="p">),</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;_city&quot;</span><span class="p">)),</span> <span class="mf">0.9</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="smv.matcher.SmvEntityMatcher.doMatch">
<code class="descname">doMatch</code><span class="sig-paren">(</span><em>df1</em>, <em>df2</em>, <em>keepOriginalCols=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/matcher.html#SmvEntityMatcher.doMatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.matcher.SmvEntityMatcher.doMatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply <cite>SmvEntityMatcher</cite> to the 2 DataFrames</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>df1</strong> (<em>DataFrame</em>) – DataFrame 1 with an id column with name “id”</li>
<li><strong>df2</strong> (<em>DataFrame</em>) – DataFrame 2 with an id column with name “id”</li>
<li><strong>keepOriginalCols</strong> (<em>boolean</em>) – whether to keep all input columns of df1 and df2, defaults to true</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SmvEntityMatcher</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;_id&quot;</span><span class="p">,</span>
    <span class="n">ExactMatchPreFilter</span><span class="p">(</span><span class="s2">&quot;Full_Name_Match&quot;</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;full_name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;_full_name&quot;</span><span class="p">)),</span>
    <span class="n">GroupCondition</span><span class="p">(</span><span class="n">soundex</span><span class="p">(</span><span class="s2">&quot;first_name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">soundex</span><span class="p">(</span><span class="s2">&quot;_first_name&quot;</span><span class="p">)),</span>
    <span class="p">[</span>
        <span class="n">ExactLogic</span><span class="p">(</span><span class="s2">&quot;First_Name_Match&quot;</span><span class="p">,</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;first_name&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">col</span><span class="p">(</span><span class="s2">&quot;_first_name&quot;</span><span class="p">)),</span>
        <span class="n">FuzzyLogic</span><span class="p">(</span><span class="s2">&quot;Levenshtein_City&quot;</span><span class="p">,</span> <span class="n">lit</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span> <span class="n">normlevenshtein</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;city&quot;</span><span class="p">),</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;_city&quot;</span><span class="p">)),</span> <span class="mf">0.9</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">doMatch</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a DataFrame with df1’s id and df2’s id and match flags of all the levels. For levels with fuzzy logic, the matching score is also provided. A column named “MatchBitmap” also provided to summarize all the matching flags. When keepOriginalCols is true, input columns are also kept</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-smv.panel">
<span id="smv-panel-module"></span><h2>smv.panel module<a class="headerlink" href="#module-smv.panel" title="Permalink to this headline">¶</a></h2>
<p>SMV PartialTime and TimePanel Framework</p>
<p>This module defines the most used PartialTime including <cite>Day</cite>, <cite>Month</cite>, <cite>Week</cite>, <cite>Quarter</cite>, and the TimePanel</p>
<dl class="docutils">
<dt>PartialTime is the base class of</dt>
<dd><ul class="first last simple">
<li>Day</li>
<li>Month</li>
<li>Week</li>
<li>Quarter</li>
</ul>
</dd>
<dt>PartialTime has the following methods</dt>
<dd><ul class="first last simple">
<li>smvTime(): returns (str), will be the value of the <cite>smvTime</cite> column if added to a DF</li>
<li><dl class="first docutils">
<dt>timeIndex(): returns (int), an integer incremental by one as the PartialTime increase</dt>
<dd>by one unit</dd>
</dl>
</li>
<li>timeLabel(): returns (str), a human readable string</li>
<li>timeType(): returns (str), the type of the PartialTime</li>
</ul>
</dd>
</dl>
<dl class="function">
<dt id="smv.panel.Day">
<code class="descclassname">smv.panel.</code><code class="descname">Day</code><span class="sig-paren">(</span><em>year</em>, <em>month</em>, <em>day</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/panel.html#Day"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.panel.Day" title="Permalink to this definition">¶</a></dt>
<dd><p>Define an smv.panel.Day</p>
<p>Day extends smv.panel.PartialTime base class</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>year</strong> (<em>int</em>) – </li>
<li><strong>month</strong> (<em>int</em>) – </li>
<li><strong>day</strong> (<em>int</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">Day</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">smvTime</span><span class="p">()</span>
<span class="go">u&#39;D20120531&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">timeIndex</span><span class="p">()</span>
<span class="go">15491</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">timeLabel</span><span class="p">()</span>
<span class="go">u&#39;2012-05-31&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">timeType</span><span class="p">()</span>
<span class="go">u&#39;day&#39;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(java object smv.panel.Day)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.panel.Month">
<code class="descclassname">smv.panel.</code><code class="descname">Month</code><span class="sig-paren">(</span><em>year</em>, <em>month</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/panel.html#Month"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.panel.Month" title="Permalink to this definition">¶</a></dt>
<dd><p>Define an smv.panel.Month</p>
<p>Month extends smv.panel.PartialTime base class</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>year</strong> (<em>int</em>) – </li>
<li><strong>month</strong> (<em>int</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Month</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">smvTime</span><span class="p">()</span>
<span class="go">u&#39;M201205&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">timeIndex</span><span class="p">()</span>
<span class="go">508</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">timeLabel</span><span class="p">()</span>
<span class="go">u&#39;2012-05&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">timeType</span><span class="p">()</span>
<span class="go">u&#39;month&#39;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(java object smv.panel.Month)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.panel.Quarter">
<code class="descclassname">smv.panel.</code><code class="descname">Quarter</code><span class="sig-paren">(</span><em>year</em>, <em>quarter</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/panel.html#Quarter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.panel.Quarter" title="Permalink to this definition">¶</a></dt>
<dd><p>Define an smv.panel.Quarter</p>
<p>Quarter extends smv.panel.PartialTime base class</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>year</strong> (<em>int</em>) – </li>
<li><strong>quarter</strong> (<em>int</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">Quarter</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">smvTime</span><span class="p">()</span>
<span class="go">u&#39;Q201201&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">timeIndex</span><span class="p">()</span>
<span class="go">168</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">timeLabel</span><span class="p">()</span>
<span class="go">u&#39;2012-Q1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">timeType</span><span class="p">()</span>
<span class="go">u&#39;quarter&#39;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(java object smv.panel.Quarter)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.panel.TimePanel">
<code class="descclassname">smv.panel.</code><code class="descname">TimePanel</code><span class="sig-paren">(</span><em>start</em>, <em>end</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/panel.html#TimePanel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.panel.TimePanel" title="Permalink to this definition">¶</a></dt>
<dd><p>Define an smv.panel.TimePanel</p>
<blockquote>
<div>TimePanel is a consecutive range of PartialTimes
It has a “start” PartialTime and “end” PartialTime, both are inclusive.
“start” and “end” have to have the same timeType</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>start</strong> (<em>java object smv.PartialTime</em>) – Quarter, Month, Day etc.</li>
<li><strong>end</strong> (<em>java object smv.PartialTime</em>) – Quarter, Month, Day etc.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tp</span> <span class="o">=</span> <span class="n">TimePanel</span><span class="p">(</span><span class="n">Day</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Day</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">))</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(java object smv.panel.TimePanel)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.panel.Week">
<code class="descclassname">smv.panel.</code><code class="descname">Week</code><span class="sig-paren">(</span><em>year</em>, <em>month</em>, <em>day</em>, <em>start_on='Monday'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/panel.html#Week"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.panel.Week" title="Permalink to this definition">¶</a></dt>
<dd><p>Define an smv.panel.Week</p>
<p>Week extends smv.panel.PartialTime base class</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>year</strong> (<em>int</em>) – </li>
<li><strong>month</strong> (<em>int</em>) – </li>
<li><strong>day</strong> (<em>int</em>) – </li>
<li><strong>start_on</strong> (<em>str</em>) – Week starts on, valid values: Monday, Tuesday, Wednesday,
Thursday, Friday, Saturday, Sunday. Default value is Monday</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">Week</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">smvTime</span><span class="p">()</span>
<span class="go">u&#39;W20120227&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">timeIndex</span><span class="p">()</span>
<span class="go">2200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">timeLabel</span><span class="p">()</span>
<span class="go">u&#39;Week of 2012-02-27&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">timeType</span><span class="p">()</span>
<span class="go">u&#39;week&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">Week</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;Sunday&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">timeType</span><span class="p">()</span>
<span class="go">u&#39;week_start_on_Sunday&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">smvTime</span><span class="p">()</span>
<span class="go">u&#39;W(7)20120304&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">timeIndex</span><span class="p">()</span>
<span class="go">2201</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">timeLabel</span><span class="p">()</span>
<span class="go">u&#39;Week of 2012-03-04&#39;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(java object smv.panel.Week)</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="smv-py4j-interface-module">
<h2>smv.py4j_interface module<a class="headerlink" href="#smv-py4j-interface-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-smv.runconfig">
<span id="smv-runconfig-module"></span><h2>smv.runconfig module<a class="headerlink" href="#module-smv.runconfig" title="Permalink to this headline">¶</a></h2>
<p>SMV User Run Configuration Parameters</p>
<p>This module defined the SmvRunConfig class which can be mixed-in into an
SmvModule to get user configuration parameters at run-time.</p>
<dl class="class">
<dt id="smv.runconfig.SmvRunConfig">
<em class="property">class </em><code class="descclassname">smv.runconfig.</code><code class="descname">SmvRunConfig</code><a class="reference internal" href="_modules/smv/runconfig.html#SmvRunConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.runconfig.SmvRunConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>DEPRECATED</p>
<p>Run config accessor methods have been absorbed by SmvGenericModule, so <cite>SmvRunConfig</cite> is maintained
to support existing projects. <cite>SmvRunConfig’s</cite> influence on the dataset hash is preserved so that
modules do not have to transition overnight to using <cite>SmvGenericModule.requiresConfig</cite> in order for the
config to influence the dataset hash.</p>
</dd></dl>

</div>
<div class="section" id="module-smv.smvapp">
<span id="smv-smvapp-module"></span><h2>smv.smvapp module<a class="headerlink" href="#module-smv.smvapp" title="Permalink to this headline">¶</a></h2>
<p>SmvApp entry class
This module provides the main SMV Python entry point <code class="docutils literal notranslate"><span class="pre">SmvPy</span></code> class and a singleton <cite>smvApp</cite>.
It is equivalent to <code class="docutils literal notranslate"><span class="pre">SmvApp</span></code> on Scala side</p>
<dl class="class">
<dt id="smv.smvapp.SmvApp">
<em class="property">class </em><code class="descclassname">smv.smvapp.</code><code class="descname">SmvApp</code><span class="sig-paren">(</span><em>arglist</em>, <em>_sparkSession</em>, <em>py_module_hotload=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The Python representation of SMV.</p>
<p>Its singleton instance is created later in the containing module
and is named smvApp</p>
<p>Adds <cite>java_imports</cite> to the namespace in the JVM gateway in
SparkContext (in pyspark).  It also creates an instance of
SmvPyClient.</p>
<dl class="attribute">
<dt id="smv.smvapp.SmvApp.SEMI_PRIVATE_LIB_PREFIX">
<code class="descname">SEMI_PRIVATE_LIB_PREFIX</code><em class="property"> = 'dsalib'</em><a class="headerlink" href="#smv.smvapp.SmvApp.SEMI_PRIVATE_LIB_PREFIX" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="smv.smvapp.SmvApp.SRC_LIB_PATH">
<code class="descname">SRC_LIB_PATH</code><em class="property"> = 'library'</em><a class="headerlink" href="#smv.smvapp.SmvApp.SRC_LIB_PATH" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="smv.smvapp.SmvApp.SRC_PROJECT_PATH">
<code class="descname">SRC_PROJECT_PATH</code><em class="property"> = 'src/main/python'</em><a class="headerlink" href="#smv.smvapp.SmvApp.SRC_PROJECT_PATH" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.abs_path_for_project_path">
<code class="descname">abs_path_for_project_path</code><span class="sig-paren">(</span><em>project_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.abs_path_for_project_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.abs_path_for_project_path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.all_data_dirs">
<code class="descname">all_data_dirs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.all_data_dirs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.all_data_dirs" title="Permalink to this definition">¶</a></dt>
<dd><p>All the config data dirs as an object.
Could be dynamic, so calculate each time when use</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.appDir">
<code class="descname">appDir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.appDir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.appDir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.appId">
<code class="descname">appId</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.appId"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.appId" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.appName">
<code class="descname">appName</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.appName"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.appName" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.copyToHdfs">
<code class="descname">copyToHdfs</code><span class="sig-paren">(</span><em>fileobj</em>, <em>destination</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.copyToHdfs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.copyToHdfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies the content of a file object to an HDFS location.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fileobj</strong> (<em>file object</em>) – a file-like object whose content is to be copied,
such as one returned by open(), or StringIO</li>
<li><strong>destination</strong> (<em>str</em>) – specifies the destination path in the hadoop file system</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The file object is expected to have been opened in binary read mode.</p>
<p>The file object is closed when this function completes.</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.createDF">
<code class="descname">createDF</code><span class="sig-paren">(</span><em>schema</em>, <em>data=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.createDF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.createDF" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.createDFWithLogger">
<code class="descname">createDFWithLogger</code><span class="sig-paren">(</span><em>schema</em>, <em>data</em>, <em>readerLogger</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.createDFWithLogger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.createDFWithLogger" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="smv.smvapp.SmvApp.createInstance">
<em class="property">classmethod </em><code class="descname">createInstance</code><span class="sig-paren">(</span><em>arglist</em>, <em>_sparkSession</em>, <em>py_module_hotload=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.createInstance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.createInstance" title="Permalink to this definition">¶</a></dt>
<dd><p>Create singleton instance. Also returns the instance.</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.defaultCsvWithHeader">
<code class="descname">defaultCsvWithHeader</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.defaultCsvWithHeader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.defaultCsvWithHeader" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.defaultTsv">
<code class="descname">defaultTsv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.defaultTsv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.defaultTsv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.defaultTsvWithHeader">
<code class="descname">defaultTsvWithHeader</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.defaultTsvWithHeader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.defaultTsvWithHeader" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.discoverSchemaAsSmvSchema">
<code class="descname">discoverSchemaAsSmvSchema</code><span class="sig-paren">(</span><em>path</em>, <em>csvAttributes</em>, <em>n=100000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.discoverSchemaAsSmvSchema"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.discoverSchemaAsSmvSchema" title="Permalink to this definition">¶</a></dt>
<dd><p>Discovers the schema of a .csv file and returns a Scala SmvSchema instance</p>
<p>path — path to csvfile
n — number of records used to discover schema (optional)
csvAttributes — Scala CsvAttributes instance (optional)</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.exception_handling">
<code class="descname">exception_handling</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.exception_handling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.exception_handling" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator function to catch Py4JJavaError and raise SmvDqmValidationError if any.
Otherwise just pass through the original exception</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.getConf">
<code class="descname">getConf</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.getConf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.getConf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.getCurrentProperties">
<code class="descname">getCurrentProperties</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.getCurrentProperties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.getCurrentProperties" title="Permalink to this definition">¶</a></dt>
<dd><p>Python dict of current megred props
defaultProps ++ appConfProps ++ homeConfProps ++ usrConfProps ++ cmdLineProps ++ dynamicRunConfig
Where right wins out in map merge.</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.getDsHash">
<code class="descname">getDsHash</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.getDsHash"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.getDsHash" title="Permalink to this definition">¶</a></dt>
<dd><p>The current hashOfHash for the named module as a hex string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<em>str</em>) – The uniquen name of a module. Does not have to be the FQN.</li>
<li><strong>runConfig</strong> (<em>dict</em>) – runConfig to apply when collecting info. If module
was run with a config, the same config needs to be
specified here to retrieve the correct hash.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The hashOfHash of the named module</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(str)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.getFileNamesByType">
<code class="descname">getFileNamesByType</code><span class="sig-paren">(</span><em>ftype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.getFileNamesByType"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.getFileNamesByType" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of file names which has the postfix ftype</p>
</dd></dl>

<dl class="classmethod">
<dt id="smv.smvapp.SmvApp.getInstance">
<em class="property">classmethod </em><code class="descname">getInstance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.getInstance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.getInstance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.getMetadataHistoryJson">
<code class="descname">getMetadataHistoryJson</code><span class="sig-paren">(</span><em>fqn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.getMetadataHistoryJson"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.getMetadataHistoryJson" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the metadata history for a given fqn</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.getMetadataJson">
<code class="descname">getMetadataJson</code><span class="sig-paren">(</span><em>fqn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.getMetadataJson"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.getMetadataJson" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the metadata for a given fqn</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.getModuleResult">
<code class="descname">getModuleResult</code><span class="sig-paren">(</span><em>fqn</em>, <em>forceRun=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.getModuleResult"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.getModuleResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Run module and get its result, which may not be a DataFrame</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.getRunInfo">
<code class="descname">getRunInfo</code><span class="sig-paren">(</span><em>fqn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.getRunInfo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.getRunInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the run information of a module and all its dependencies
from the last run.</p>
<p>Unlike the runModule() method, which returns the run
information just for that run, this method returns the run
information from the last run.</p>
<p>If no module was run (e.g. the code did not change, so the
data is read from persistent storage), the SmRunInfoCollector
returned from the runModule() method would be empty.  But the
SmvRunInfoCollector returned from this method would contain
all latest run information about all dependent modules.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fqn</strong> (<em>str</em>) – fqn of target module</li>
<li><strong>runConfig</strong> (<em>dict</em>) – runConfig to apply when collecting info. If module
was run with a config, the same config needs to be
specified here to retrieve the info.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">SmvRunInfoCollector</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.getRunInfoByPartialName">
<code class="descname">getRunInfoByPartialName</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.getRunInfoByPartialName"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.getRunInfoByPartialName" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the run information of a module and all its dependencies
from the last run.</p>
<p>Unlike the runModule() method, which returns the run
information just for that run, this method returns the run
information from the last run.</p>
<p>If no module was run (e.g. the code did not change, so the
data is read from persistent storage), the SmRunInfoCollector
returned from the runModule() method would be empty.  But the
SmvRunInfoCollector returned from this method would contain
all latest run information about all dependent modules.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) – unique suffix to fqn of target module</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">SmvRunInfoCollector</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.getSchemaByDataFileAsSmvSchema">
<code class="descname">getSchemaByDataFileAsSmvSchema</code><span class="sig-paren">(</span><em>data_file_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.getSchemaByDataFileAsSmvSchema"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.getSchemaByDataFileAsSmvSchema" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the schema of a data file from its path and returns a Scala SmvSchema instance.
The result will be None if the corresponding schema file does not exist or is invalid.</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.getStageFromModuleFqn">
<code class="descname">getStageFromModuleFqn</code><span class="sig-paren">(</span><em>fqn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.getStageFromModuleFqn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.getStageFromModuleFqn" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the stage name for a given fqn</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.get_graph_json">
<code class="descname">get_graph_json</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.get_graph_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.get_graph_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a json string representing the dependency graph.</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.get_module_state_json">
<code class="descname">get_module_state_json</code><span class="sig-paren">(</span><em>fqns</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.get_module_state_json"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.get_module_state_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a json string for modules’ needToRun state of the app</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fqns</strong> (<em>list</em><em>(</em><em>string</em><em>)</em>) – module fqn list to get state for</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">json string. E.g. {“stage.mymod”: {“needsToRun” : True}}</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(string)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.get_need_to_run">
<code class="descname">get_need_to_run</code><span class="sig-paren">(</span><em>roots</em>, <em>keep_roots=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.get_need_to_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.get_need_to_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of target modules to run, return a list of modules which
will run and be persisted in the order of how they should run. This
is a sub-set of modules_needed_for_run, but only keep the
non-ephemeral and not-persisted-yet modules.
Please note that some of the roots may not be in this list, to include
all roots, set <cite>keep_roots</cite> to True</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.get_provider_by_fqn">
<code class="descname">get_provider_by_fqn</code><span class="sig-paren">(</span><em>fqn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.get_provider_by_fqn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.get_provider_by_fqn" title="Permalink to this definition">¶</a></dt>
<dd><p>Return provider class from provider name fqn</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.get_providers_by_prefix">
<code class="descname">get_providers_by_prefix</code><span class="sig-paren">(</span><em>fqn_prefix</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.get_providers_by_prefix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.get_providers_by_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Discover all providers in user lib and smv lib that have an provider type fqn
starting with the given prefix.</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.inputDir">
<code class="descname">inputDir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.inputDir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.inputDir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.input_connection">
<code class="descname">input_connection</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.input_connection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.input_connection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.jdbcDriver">
<code class="descname">jdbcDriver</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.jdbcDriver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.jdbcDriver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.jdbcUrl">
<code class="descname">jdbcUrl</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.jdbcUrl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.jdbcUrl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.load_single_ds">
<code class="descname">load_single_ds</code><span class="sig-paren">(</span><em>fqn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.load_single_ds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.load_single_ds" title="Permalink to this definition">¶</a></dt>
<dd><p>Return ds from fqn</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.outputDir">
<code class="descname">outputDir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.outputDir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.outputDir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.prependDefaultDirs">
<code class="descname">prependDefaultDirs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.prependDefaultDirs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.prependDefaultDirs" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that mods in src/main/python and library/ are discoverable.
If we add more default dirs, we’ll make this a set</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.prepend_source">
<code class="descname">prepend_source</code><span class="sig-paren">(</span><em>project_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.prepend_source"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.prepend_source" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.publishModuleToHiveByName">
<code class="descname">publishModuleToHiveByName</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.publishModuleToHiveByName"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.publishModuleToHiveByName" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.quickRunModule">
<code class="descname">quickRunModule</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.quickRunModule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.quickRunModule" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.refresh_provider_cache">
<code class="descname">refresh_provider_cache</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.refresh_provider_cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.refresh_provider_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-discover providers and set provider_cache</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.removeDefaultDirs">
<code class="descname">removeDefaultDirs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.removeDefaultDirs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.removeDefaultDirs" title="Permalink to this definition">¶</a></dt>
<dd><p>The cleanup version of prependDefaultDirs</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.remove_source">
<code class="descname">remove_source</code><span class="sig-paren">(</span><em>project_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.remove_source"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.remove_source" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.runModule">
<code class="descname">runModule</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.runModule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.runModule" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.runModuleByName">
<code class="descname">runModuleByName</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.runModuleByName"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.runModuleByName" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.scalaNone">
<code class="descname">scalaNone</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.scalaNone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.scalaNone" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Scala None value</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.scalaOption">
<code class="descname">scalaOption</code><span class="sig-paren">(</span><em>val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.scalaOption"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.scalaOption" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Scala Option containing the value</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.setAppDir">
<code class="descname">setAppDir</code><span class="sig-paren">(</span><em>appDir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.setAppDir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.setAppDir" title="Permalink to this definition">¶</a></dt>
<dd><p>SMV’s equivalent of ‘cd’ for app dirs.</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.setDynamicRunConfig">
<code class="descname">setDynamicRunConfig</code><span class="sig-paren">(</span><em>runConfig</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.setDynamicRunConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.setDynamicRunConfig" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="smv.smvapp.SmvApp.setInstance">
<em class="property">classmethod </em><code class="descname">setInstance</code><span class="sig-paren">(</span><em>app</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.setInstance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.setInstance" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the singleton instance.</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.smvLibs">
<code class="descname">smvLibs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.smvLibs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.smvLibs" title="Permalink to this definition">¶</a></dt>
<dd><p>Use introspection to determine list of availabe smv builtin libs.</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.smvVersion">
<code class="descname">smvVersion</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.smvVersion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.smvVersion" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.stages">
<code class="descname">stages</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.stages"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.stages" title="Permalink to this definition">¶</a></dt>
<dd><p>Stages is a function as they can be set dynamically on an SmvApp instance</p>
</dd></dl>

<dl class="method">
<dt id="smv.smvapp.SmvApp.userLibs">
<code class="descname">userLibs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvapp.html#SmvApp.userLibs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvapp.SmvApp.userLibs" title="Permalink to this definition">¶</a></dt>
<dd><p>Use introspection to determine list of availabe user libs.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="smv-smvdataset-module">
<h2>smv.smvdataset module<a class="headerlink" href="#smv-smvdataset-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-smv.smvshell">
<span id="smv-smvshell-module"></span><h2>smv.smvshell module<a class="headerlink" href="#module-smv.smvshell" title="Permalink to this headline">¶</a></h2>
<p>Helper functions available in SMV’s Python shell</p>
<dl class="function">
<dt id="smv.smvshell.df">
<code class="descclassname">smv.smvshell.</code><code class="descname">df</code><span class="sig-paren">(</span><em>name</em>, <em>forceRun=False</em>, <em>quickRun=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.df" title="Permalink to this definition">¶</a></dt>
<dd><p>The DataFrame result of running the named module</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<em>str</em>) – The unique name of a module. Does not have to be the FQN.</li>
<li><strong>forceRun</strong> (<em>bool</em>) – True if the module should be forced to run even if it has persisted output. False otherwise.</li>
<li><strong>quickRun</strong> (<em>bool</em>) – skip computing dqm+metadata and persisting csv</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The result of running the named module.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(DataFrame)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.dshash">
<code class="descclassname">smv.smvshell.</code><code class="descname">dshash</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#dshash"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.dshash" title="Permalink to this definition">¶</a></dt>
<dd><p>The current hashOfHash for the named module as a hex string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<em>str</em>) – The uniquen name of a module. Does not have to be the FQN.</li>
<li><strong>runConfig</strong> (<em>dict</em>) – runConfig to apply when collecting info. If module
was run with a config, the same config needs to be
specified here to retrieve the correct hash.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The hashOfHash of the named module</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(int)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.getModel">
<code class="descclassname">smv.smvshell.</code><code class="descname">getModel</code><span class="sig-paren">(</span><em>name</em>, <em>forceRun=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#getModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.getModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the result of running the named SmvModel module</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<em>str</em>) – The name of a module. Does not have to be the FQN.</li>
<li><strong>forceRun</strong> (<em>bool</em>) – True if the module should be forced to run even if it has persisted output. False otherwise.</li>
<li><strong>version</strong> (<em>str</em>) – The name of the published version to load from</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The result of running the named module</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(object)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.openHive">
<code class="descclassname">smv.smvshell.</code><code class="descname">openHive</code><span class="sig-paren">(</span><em>tableName</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#openHive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.openHive" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in a Hive table as a DataFrame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tableName</strong> (<em>str</em>) – The name of the Hive table</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The resulting DataFrame</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.openCsv">
<code class="descclassname">smv.smvshell.</code><code class="descname">openCsv</code><span class="sig-paren">(</span><em>path</em>, <em>validate=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#openCsv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.openCsv" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in a CSV file as a DataFrame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<em>str</em>) – The path of the CSV file</li>
<li><strong>validate</strong> (<em>bool</em>) – If true, validate the CSV before return DataFrame (raise error if malformatted)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The resulting DataFrame</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(DataFrame)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.help">
<code class="descclassname">smv.smvshell.</code><code class="descname">help</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#help"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.help" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a list of the SMV helper functions available in the shell</p>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.lsStage">
<code class="descclassname">smv.smvshell.</code><code class="descname">lsStage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#lsStage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.lsStage" title="Permalink to this definition">¶</a></dt>
<dd><p>List all the stages</p>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.ls">
<code class="descclassname">smv.smvshell.</code><code class="descname">ls</code><span class="sig-paren">(</span><em>stageName=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#ls"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.ls" title="Permalink to this definition">¶</a></dt>
<dd><p>List all datasets in a stage</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>stageName</strong> (<em>str</em>) – The name of the stage. Defaults to None, in which ase all datasets in all stages will be listed.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.lsDead">
<code class="descclassname">smv.smvshell.</code><code class="descname">lsDead</code><span class="sig-paren">(</span><em>stageName=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#lsDead"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.lsDead" title="Permalink to this definition">¶</a></dt>
<dd><p>List dead datasets in a stage</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>stageName</strong> (<em>str</em>) – The name of the stage. Defaults to None, in which ase all datasets in all stages will be listed.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.props">
<code class="descclassname">smv.smvshell.</code><code class="descname">props</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#props"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.props" title="Permalink to this definition">¶</a></dt>
<dd><p>The current app propertied used by SMV after the app, user, command-line
and dynamic props are merged.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The ‘mergedProps’ or final props used by SMV</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(dict)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.exportToHive">
<code class="descclassname">smv.smvshell.</code><code class="descname">exportToHive</code><span class="sig-paren">(</span><em>dsname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#exportToHive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.exportToHive" title="Permalink to this definition">¶</a></dt>
<dd><p>Export dataset’s running result to a Hive table</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dsname</strong> (<em>str</em>) – The name of an SmvModule</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.ancestors">
<code class="descclassname">smv.smvshell.</code><code class="descname">ancestors</code><span class="sig-paren">(</span><em>dsname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#ancestors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.ancestors" title="Permalink to this definition">¶</a></dt>
<dd><p>List all ancestors of a dataset</p>
<p>Ancestors of a dataset are the dataset it depends on, directly or
in-directly, including datasets from other stages.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dsname</strong> (<em>str</em>) – The name of an SmvGenericModule</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.descendants">
<code class="descclassname">smv.smvshell.</code><code class="descname">descendants</code><span class="sig-paren">(</span><em>dsname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#descendants"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.descendants" title="Permalink to this definition">¶</a></dt>
<dd><p>List all descendants of a dataset</p>
<p>Descendants of a dataset are the datasets which depend on it directly or
in-directly, including datasets from other stages</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dsname</strong> (<em>str</em>) – The name of an SmvGenericModule</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.now">
<code class="descclassname">smv.smvshell.</code><code class="descname">now</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#now"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.now" title="Permalink to this definition">¶</a></dt>
<dd><p>Print current time</p>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.smvDiscoverSchemaToFile">
<code class="descclassname">smv.smvshell.</code><code class="descname">smvDiscoverSchemaToFile</code><span class="sig-paren">(</span><em>path</em>, <em>n=100000</em>, <em>ca=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#smvDiscoverSchemaToFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.smvDiscoverSchemaToFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Try best to discover Schema from raw Csv file</p>
<p>Will save a schema file with postfix “.toBeReviewed” in local directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> (<em>str</em>) – Path to the CSV file</li>
<li><strong>n</strong> (<em>int</em>) – Number of records to check for schema discovery, default 100k</li>
<li><strong>ca</strong> (<em>CsvAttributes</em>) – Defaults to CsvWithHeader</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.run_test">
<code class="descclassname">smv.smvshell.</code><code class="descname">run_test</code><span class="sig-paren">(</span><em>test_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#run_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.run_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a test with the given name without creating new Spark context</p>
<p>First reloads SMV and the test from source, then runs the test.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>test_name</strong> (<em>str</em>) – Name of the test to run</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.show_run_info">
<code class="descclassname">smv.smvshell.</code><code class="descname">show_run_info</code><span class="sig-paren">(</span><em>collector</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#show_run_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.show_run_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Inspects the SmvRunInfoCollector object returned by smvApp.runModule</p>
</dd></dl>

<dl class="function">
<dt id="smv.smvshell.get_run_info">
<code class="descclassname">smv.smvshell.</code><code class="descname">get_run_info</code><span class="sig-paren">(</span><em>name</em>, <em>runConfig=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/smvshell.html#get_run_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.smvshell.get_run_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the SmvRunInfoCollector with full information about a module and its dependencies</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<em>str</em>) – name of the module whose information to collect</li>
<li><strong>runConfig</strong> (<em>dict</em>) – runConfig to apply when collecting info. If module
was run with a config, the same config needs to be
specified here to retrieve the info.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-smv.utils">
<span id="smv-utils-module"></span><h2>smv.utils module<a class="headerlink" href="#module-smv.utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="smv.utils.check_socket">
<code class="descclassname">smv.utils.</code><code class="descname">check_socket</code><span class="sig-paren">(</span><em>port</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/utils.html#check_socket"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.utils.check_socket" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the given port is open to bind</p>
</dd></dl>

<dl class="function">
<dt id="smv.utils.infer_full_name_from_part">
<code class="descclassname">smv.utils.</code><code class="descname">infer_full_name_from_part</code><span class="sig-paren">(</span><em>full_names</em>, <em>part_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/utils.html#infer_full_name_from_part"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.utils.infer_full_name_from_part" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given partial name (postfix), infer full name from a list</p>
</dd></dl>

<dl class="function">
<dt id="smv.utils.is_string">
<code class="descclassname">smv.utils.</code><code class="descname">is_string</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/utils.html#is_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.utils.is_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether object is a string type with Python 2 and Python 3 compatibility</p>
</dd></dl>

<dl class="function">
<dt id="smv.utils.lazy_property">
<code class="descclassname">smv.utils.</code><code class="descname">lazy_property</code><span class="sig-paren">(</span><em>fn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/utils.html#lazy_property"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.utils.lazy_property" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator that makes a property lazy-evaluated.</p>
</dd></dl>

<dl class="function">
<dt id="smv.utils.list_distinct">
<code class="descclassname">smv.utils.</code><code class="descname">list_distinct</code><span class="sig-paren">(</span><em>l</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/utils.html#list_distinct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.utils.list_distinct" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a the distinct version of the input list, perserve order</p>
</dd></dl>

<dl class="function">
<dt id="smv.utils.scala_seq_to_list">
<code class="descclassname">smv.utils.</code><code class="descname">scala_seq_to_list</code><span class="sig-paren">(</span><em>_jvm</em>, <em>j_seq</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/utils.html#scala_seq_to_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.utils.scala_seq_to_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert Scala Seq to Python list</p>
</dd></dl>

<dl class="function">
<dt id="smv.utils.smv_copy_array">
<code class="descclassname">smv.utils.</code><code class="descname">smv_copy_array</code><span class="sig-paren">(</span><em>sc</em>, <em>*cols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/utils.html#smv_copy_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.utils.smv_copy_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy Python list to appropriate Java array</p>
</dd></dl>

<dl class="function">
<dt id="smv.utils.smvhash">
<code class="descclassname">smv.utils.</code><code class="descname">smvhash</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/smv/utils.html#smvhash"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smv.utils.smvhash" title="Permalink to this definition">¶</a></dt>
<dd><p>Python’s hash function will return different numbers from run to
from, starting from 3.  Provide a deterministic hash function for
use to calculate sourceCodeHash.</p>
</dd></dl>

</div>
<div class="section" id="module-smv">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-smv" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">smv package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-smv.csv_attributes">smv.csv_attributes module</a></li>
<li><a class="reference internal" href="#module-smv.datasetrepo">smv.datasetrepo module</a></li>
<li><a class="reference internal" href="#module-smv.dqm">smv.dqm module</a></li>
<li><a class="reference internal" href="#module-smv.error">smv.error module</a></li>
<li><a class="reference internal" href="#module-smv.functions">smv.functions module</a></li>
<li><a class="reference internal" href="#smv-graph-module">smv.graph module</a></li>
<li><a class="reference internal" href="#module-smv.helpers">smv.helpers module</a></li>
<li><a class="reference internal" href="#module-smv.matcher">smv.matcher module</a></li>
<li><a class="reference internal" href="#module-smv.panel">smv.panel module</a></li>
<li><a class="reference internal" href="#smv-py4j-interface-module">smv.py4j_interface module</a></li>
<li><a class="reference internal" href="#module-smv.runconfig">smv.runconfig module</a></li>
<li><a class="reference internal" href="#module-smv.smvapp">smv.smvapp module</a></li>
<li><a class="reference internal" href="#smv-smvdataset-module">smv.smvdataset module</a></li>
<li><a class="reference internal" href="#module-smv.smvshell">smv.smvshell module</a></li>
<li><a class="reference internal" href="#module-smv.utils">smv.utils module</a></li>
<li><a class="reference internal" href="#module-smv">Module contents</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to smv’s documentation!</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/smv.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to smv’s documentation!"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Spark Modularized View v2r6 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, TresAmigosSD.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.
    </div>
  </body>
</html>