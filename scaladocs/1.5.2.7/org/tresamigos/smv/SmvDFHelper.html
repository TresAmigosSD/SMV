<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html>
        <head>
          <title>SmvDFHelper - org.tresamigos.smv.SmvDFHelper</title>
          <meta name="description" content="SmvDFHelper - org.tresamigos.smv.SmvDFHelper" />
          <meta name="keywords" content="SmvDFHelper org.tresamigos.smv.SmvDFHelper" />
          <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
          
      <link href="../../../lib/template.css" media="screen" type="text/css" rel="stylesheet" />
      <link href="../../../lib/diagrams.css" media="screen" type="text/css" rel="stylesheet" id="diagrams-css" />
      <script type="text/javascript">
         if(top === self) {
            var url = '../../../index.html';
            var hash = 'org.tresamigos.smv.SmvDFHelper';
            var anchor = window.location.hash;
            var anchor_opt = '';
            if (anchor.length >= 1)
              anchor_opt = '@' + anchor.substring(1);
            window.location.href = url + '#' + hash + anchor_opt;
         }
   	  </script>
    
        </head>
        <body class="type">
      <div id="definition">
        <img src="../../../lib/class_big.png" />
        <p id="owner"><a href="../../package.html" class="extype" name="org">org</a>.<a href="../package.html" class="extype" name="org.tresamigos">tresamigos</a>.<a href="package.html" class="extype" name="org.tresamigos.smv">smv</a></p>
        <h1>SmvDFHelper</h1>
      </div>

      <h4 id="signature" class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">class</span>
      </span>
      <span class="symbol">
        <span class="name">SmvDFHelper</span><span class="result"> extends <span class="extype" name="scala.AnyRef">AnyRef</span></span>
      </span>
      </h4>
      
          <div id="comment" class="fullcommenttop"><div class="toggleContainer block">
          <span class="toggle">Linear Supertypes</span>
          <div class="superTypes hiddenContent"><span class="extype" name="scala.AnyRef">AnyRef</span>, <span class="extype" name="scala.Any">Any</span></div>
        </div></div>
        

      <div id="mbrsel">
        <div id="textfilter"><span class="pre"></span><span class="input"><input id="mbrsel-input" type="text" accesskey="/" /></span><span class="post"></span></div>
        <div id="order">
              <span class="filtertype">Ordering</span>
              <ol>
                
                <li class="alpha in"><span>Alphabetic</span></li>
                <li class="inherit out"><span>By inheritance</span></li>
              </ol>
            </div>
        <div id="ancestors">
                <span class="filtertype">Inherited<br />
                </span>
                <ol id="linearization">
                  <li class="in" name="org.tresamigos.smv.SmvDFHelper"><span>SmvDFHelper</span></li><li class="in" name="scala.AnyRef"><span>AnyRef</span></li><li class="in" name="scala.Any"><span>Any</span></li>
                </ol>
              </div><div id="ancestors">
            <span class="filtertype"></span>
            <ol>
              <li class="hideall out"><span>Hide All</span></li>
              <li class="showall in"><span>Show all</span></li>
            </ol>
            <a href="http://docs.scala-lang.org/overviews/scaladoc/usage.html#members" target="_blank">Learn more about member selection</a>
          </div>
        <div id="visbl">
            <span class="filtertype">Visibility</span>
            <ol><li class="public in"><span>Public</span></li><li class="all out"><span>All</span></li></ol>
          </div>
      </div>

      <div id="template">
        <div id="allMembers">
        <div id="constructors" class="members">
              <h3>Instance Constructors</h3>
              <ol><li name="org.tresamigos.smv.SmvDFHelper#&lt;init&gt;" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="&lt;init&gt;(df:org.apache.spark.sql.DataFrame):org.tresamigos.smv.SmvDFHelper"></a>
      <a id="&lt;init&gt;:SmvDFHelper"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">new</span>
      </span>
      <span class="symbol">
        <span class="name">SmvDFHelper</span><span class="params">(<span name="df">df: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>)</span>
      </span>
      </h4>
      
    </li></ol>
            </div>

        

        

        <div id="values" class="values members">
              <h3>Value Members</h3>
              <ol><li name="scala.AnyRef#!=" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="!=(x$1:AnyRef):Boolean"></a>
      <a id="!=(AnyRef):Boolean"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span title="gt4s: $bang$eq" class="name">!=</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.AnyRef">AnyRef</span></span>)</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd></dl></div>
    </li><li name="scala.Any#!=" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="!=(x$1:Any):Boolean"></a>
      <a id="!=(Any):Boolean"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span title="gt4s: $bang$eq" class="name">!=</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.Any">Any</span></span>)</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>Any</dd></dl></div>
    </li><li name="scala.AnyRef###" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="##():Int"></a>
      <a id="##():Int"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span title="gt4s: $hash$hash" class="name">##</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Int">Int</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div>
    </li><li name="scala.AnyRef#==" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="==(x$1:AnyRef):Boolean"></a>
      <a id="==(AnyRef):Boolean"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span title="gt4s: $eq$eq" class="name">==</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.AnyRef">AnyRef</span></span>)</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd></dl></div>
    </li><li name="scala.Any#==" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="==(x$1:Any):Boolean"></a>
      <a id="==(Any):Boolean"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span title="gt4s: $eq$eq" class="name">==</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.Any">Any</span></span>)</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>Any</dd></dl></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#_smvDumpDF" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="_smvDumpDF():String"></a>
      <a id="_smvDumpDF():String"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">_smvDumpDF</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Predef.String">String</span></span>
      </span>
      </h4>
      
    </li><li name="scala.Any#asInstanceOf" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="asInstanceOf[T0]:T0"></a>
      <a id="asInstanceOf[T0]:T0"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">asInstanceOf</span><span class="tparams">[<span name="T0">T0</span>]</span><span class="result">: <span class="extype" name="scala.Any.asInstanceOf.T0">T0</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>Any</dd></dl></div>
    </li><li name="scala.AnyRef#clone" visbl="prt" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="clone():Object"></a>
      <a id="clone():AnyRef"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">clone</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.AnyRef">AnyRef</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Attributes</dt><dd>protected[<a href="../../../java$lang.html" class="extype" name="java.lang">java.lang</a>] </dd><dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd>
                <span class="name">@throws</span><span class="args">(<span>
      
      <span class="defval" name="classOf[java.lang.CloneNotSupportedException]">...</span>
    </span>)</span>
              
        </dd></dl></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#dedupByKey" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="dedupByKey(cols:org.apache.spark.sql.Column*):org.apache.spark.sql.DataFrame"></a>
      <a id="dedupByKey(Column*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">dedupByKey</span><span class="params">(<span name="cols">cols: <span class="extype" name="org.apache.spark.sql.Column">Column</span>*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Same as <code>dedupByKey(String*)</code> but uses <code>Column</code> to specify the key columns</p>
    </li><li name="org.tresamigos.smv.SmvDFHelper#dedupByKey" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="dedupByKey(k1:String,krest:String*):org.apache.spark.sql.DataFrame"></a>
      <a id="dedupByKey(String,String*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">dedupByKey</span><span class="params">(<span name="k1">k1: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="krest">krest: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Remove duplicate records from the <code>DataFrame</code> by arbitrarly selecting the first record
from a set of records with same primary key or key combo.</p><div class="fullcomment"><div class="comment cmt"><p>Remove duplicate records from the <code>DataFrame</code> by arbitrarly selecting the first record
from a set of records with same primary key or key combo.
For example, given the following input DataFrame:</p><pre>| id  | product | Company |
| --- | ------- | ------- |
| <span class="num">1</span>   | A       | C1      |
| <span class="num">1</span>   | C       | C2      |
| <span class="num">2</span>   | B       | C3      |
| <span class="num">2</span>   | B       | C4      |</pre><p>and the following call:</p><pre>df.dedupByKey(<span class="lit">"id"</span>)</pre><p>will yield the following <code>DataFrame</code>:</p><pre>| id  | product | Company |
| --- | ------- | ------- |
| <span class="num">1</span>   | A       | C1      |
| <span class="num">2</span>   | B       | C3      |</pre><p>while the following call:</p><pre>df.dedupByKey(<span class="lit">"id"</span>, <span class="lit">"product"</span>)</pre><p>will yield the following:</p><pre>| id  | product | Company |
| --- | ------- | ------- |
| <span class="num">1</span>   | A       | C1      |
| <span class="num">1</span>   | C       | C2      |
| <span class="num">2</span>   | B       | C3      |</pre></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#dedupByKeyWithOrder" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="dedupByKeyWithOrder(k1:String,krest:String*)(orderCol:org.apache.spark.sql.Column*):org.apache.spark.sql.DataFrame"></a>
      <a id="dedupByKeyWithOrder(String,String*)(Column*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">dedupByKeyWithOrder</span><span class="params">(<span name="k1">k1: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="krest">krest: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="params">(<span name="orderCol">orderCol: <span class="extype" name="org.apache.spark.sql.Column">Column</span>*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Same as <code>dedupByKeyWithOrder(Column*)(Column*)</code> but use <code>String</code> as key *</p>
    </li><li name="org.tresamigos.smv.SmvDFHelper#dedupByKeyWithOrder" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="dedupByKeyWithOrder(keyCol:org.apache.spark.sql.Column*)(orderCol:org.apache.spark.sql.Column*):org.apache.spark.sql.DataFrame"></a>
      <a id="dedupByKeyWithOrder(Column*)(Column*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">dedupByKeyWithOrder</span><span class="params">(<span name="keyCol">keyCol: <span class="extype" name="org.apache.spark.sql.Column">Column</span>*</span>)</span><span class="params">(<span name="orderCol">orderCol: <span class="extype" name="org.apache.spark.sql.Column">Column</span>*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Remove duplicated records by selecting the first record regarding a given ordering
For example, given the following input DataFrame:</p><div class="fullcomment"><div class="comment cmt"><p>Remove duplicated records by selecting the first record regarding a given ordering
For example, given the following input DataFrame:</p><pre>| id  | product | Company |
| --- | ------- | ------- |
| <span class="num">1</span>   | A       | C1      |
| <span class="num">1</span>   | C       | C2      |
| <span class="num">2</span>   | B       | C3      |
| <span class="num">2</span>   | B       | C4      |</pre><p>and the following call:</p><pre>df.dedupByKeyWithOrder($<span class="lit">"id"</span>)($<span class="lit">"product"</span>.desc)</pre><p>will yield the following <code>DataFrame</code>:</p><pre>| id  | product | Company |
| --- | ------- | ------- |
| <span class="num">1</span>   | C       | C2      |
| <span class="num">2</span>   | B       | C3      |</pre><p>Same as the <code>dedupByKey</code> method, we use RDD groupBy in the implementation of this
method to make sure we can handel large key space.
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#edd" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="edd:org.tresamigos.smv.edd.Edd"></a>
      <a id="edd:Edd"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">edd</span><span class="result">: <a href="edd/Edd.html" class="extype" name="org.tresamigos.smv.edd.Edd">Edd</a></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Create an Edd on DataFrame.</p><div class="fullcomment"><div class="comment cmt"><p>Create an Edd on DataFrame.
See <a href="edd/Edd.html" class="extype" name="org.tresamigos.smv.edd.Edd">org.tresamigos.smv.edd.Edd</a> for details.</p><p>Example:</p><pre>scala&gt; df.edd.summary().eddShow</pre></div><dl class="attributes block"> <dt>Annotations</dt><dd>
                <span class="name">@Experimental</span><span class="args">()</span>
              
        </dd></dl></div>
    </li><li name="scala.AnyRef#eq" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="eq(x$1:AnyRef):Boolean"></a>
      <a id="eq(AnyRef):Boolean"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">eq</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.AnyRef">AnyRef</span></span>)</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd></dl></div>
    </li><li name="scala.AnyRef#equals" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="equals(x$1:Any):Boolean"></a>
      <a id="equals(Any):Boolean"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">equals</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.Any">Any</span></span>)</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div>
    </li><li name="scala.AnyRef#finalize" visbl="prt" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="finalize():Unit"></a>
      <a id="finalize():Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">finalize</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Attributes</dt><dd>protected[<a href="../../../java$lang.html" class="extype" name="java.lang">java.lang</a>] </dd><dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd>
                <span class="name">@throws</span><span class="args">(<span>
      
      <span class="symbol">classOf[java.lang.Throwable]</span>
    </span>)</span>
              
        </dd></dl></div>
    </li><li name="scala.AnyRef#getClass" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="getClass():Class[_]"></a>
      <a id="getClass():Class[_]"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">getClass</span><span class="params">()</span><span class="result">: <span class="extype" name="java.lang.Class">Class</span>[_]</span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div>
    </li><li name="scala.AnyRef#hashCode" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="hashCode():Int"></a>
      <a id="hashCode():Int"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">hashCode</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Int">Int</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div>
    </li><li name="scala.Any#isInstanceOf" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="isInstanceOf[T0]:Boolean"></a>
      <a id="isInstanceOf[T0]:Boolean"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">isInstanceOf</span><span class="tparams">[<span name="T0">T0</span>]</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>Any</dd></dl></div>
    </li><li name="scala.AnyRef#ne" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="ne(x$1:AnyRef):Boolean"></a>
      <a id="ne(AnyRef):Boolean"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">ne</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.AnyRef">AnyRef</span></span>)</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd></dl></div>
    </li><li name="scala.AnyRef#notify" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="notify():Unit"></a>
      <a id="notify():Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">notify</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd></dl></div>
    </li><li name="scala.AnyRef#notifyAll" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="notifyAll():Unit"></a>
      <a id="notifyAll():Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">notifyAll</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd></dl></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#peek" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="peek(colRegex:String):Unit"></a>
      <a id="peek(String):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">peek</span><span class="params">(<span name="colRegex">colRegex: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Display 1st row in transposed view
</p><div class="fullcomment"><div class="comment cmt"><p>Display 1st row in transposed view
</p></div><dl class="paramcmts block"><dt class="param">colRegex</dt><dd class="cmt"><p>show the columns with name match the regex, default as &quot;.*&quot;
</p></dd></dl></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#peek" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="peek():Unit"></a>
      <a id="peek():Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">peek</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Use default peek with or without the parenthesis
</p>
    </li><li name="org.tresamigos.smv.SmvDFHelper#peek" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="peek(pos:Int,colRegex:String):Unit"></a>
      <a id="peek(Int,String):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">peek</span><span class="params">(<span name="pos">pos: <span class="extype" name="scala.Int">Int</span></span>, <span name="colRegex">colRegex: <span class="extype" name="scala.Predef.String">String</span> = <span class="symbol">&quot;.*&quot;</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Display a dataframe row in transposed view.</p><div class="fullcomment"><div class="comment cmt"><p>Display a dataframe row in transposed view.
</p></div><dl class="paramcmts block"><dt class="param">pos</dt><dd class="cmt"><p>the n-th row to display, default as 1</p></dd><dt class="param">colRegex</dt><dd class="cmt"><p>show the columns with name match the regex, default as &quot;.*&quot;
</p></dd></dl></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#peekSave" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="peekSave(path:String,pos:Int,colRegex:String):Unit"></a>
      <a id="peekSave(String,Int,String):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">peekSave</span><span class="params">(<span name="path">path: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="pos">pos: <span class="extype" name="scala.Int">Int</span> = <span class="symbol">1</span></span>, <span name="colRegex">colRegex: <span class="extype" name="scala.Predef.String">String</span> = <span class="symbol">&quot;.*&quot;</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Write <code>peek</code> result to a file
</p><div class="fullcomment"><div class="comment cmt"><p>Write <code>peek</code> result to a file
</p></div><dl class="paramcmts block"><dt class="param">path</dt><dd class="cmt"><p>local file name to write</p></dd><dt class="param">pos</dt><dd class="cmt"><p>the n-th row to display, default as 1</p></dd><dt class="param">colRegex</dt><dd class="cmt"><p>show the columns with names match the regex, default as &quot;.*&quot;
</p></dd></dl></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#postfixFieldNames" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="postfixFieldNames(postfix:String):org.apache.spark.sql.DataFrame"></a>
      <a id="postfixFieldNames(String):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">postfixFieldNames</span><span class="params">(<span name="postfix">postfix: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Apply a posfix to all column names in the given <code>DataFrame</code>.</p><div class="fullcomment"><div class="comment cmt"><p>Apply a posfix to all column names in the given <code>DataFrame</code>.
For Example:</p><pre>df.posfixFieldNames(<span class="lit">"_x"</span>)</pre><p>The above will add &quot;_x&quot; to the end of every column name in the <code>DataFrame</code>
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#prefixFieldNames" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="prefixFieldNames(prefix:String):org.apache.spark.sql.DataFrame"></a>
      <a id="prefixFieldNames(String):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">prefixFieldNames</span><span class="params">(<span name="prefix">prefix: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Apply a prefix to all column names in the given <code>DataFrame</code>.</p><div class="fullcomment"><div class="comment cmt"><p>Apply a prefix to all column names in the given <code>DataFrame</code>.
For Example:</p><pre>df.prefixFieldNames(<span class="lit">"x_"</span>)</pre><p>The above will add &quot;x_&quot; to the beginning of every column name in the <code>DataFrame</code>
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#printDesc" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="printDesc():Unit"></a>
      <a id="printDesc():Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">printDesc</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Print column names with description
e.</p><div class="fullcomment"><div class="comment cmt"><p>Print column names with description
e.g.</p><pre>scala&gt; <span class="kw">val</span> res = df.smvDesc(<span class="lit">"a"</span> -&gt; <span class="lit">"column a is ...."</span>)
scala&gt; res.printDesc</pre></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#saveAsCsvWithSchema" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="saveAsCsvWithSchema(dataPath:String,ca:org.tresamigos.smv.CsvAttributes,schemaWithMeta:org.tresamigos.smv.SmvSchema,strNullValue:String):Unit"></a>
      <a id="saveAsCsvWithSchema(String,CsvAttributes,SmvSchema,String):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">saveAsCsvWithSchema</span><span class="params">(<span name="dataPath">dataPath: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="ca">ca: <a href="CsvAttributes.html" class="extype" name="org.tresamigos.smv.CsvAttributes">CsvAttributes</a> = <span class="symbol"><span class="name"><a href="CsvAttributes$.html">CsvAttributes.defaultCsv</a></span></span></span>, <span name="schemaWithMeta">schemaWithMeta: <a href="SmvSchema.html" class="extype" name="org.tresamigos.smv.SmvSchema">SmvSchema</a> = <span class="symbol">null</span></span>, <span name="strNullValue">strNullValue: <span class="extype" name="scala.Predef.String">String</span> = <span class="symbol">&quot;&quot;</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">persist the <code>DataFrame</code> as a CSV file (along with a schema file).</p><div class="fullcomment"><div class="comment cmt"><p>persist the <code>DataFrame</code> as a CSV file (along with a schema file).</p><pre>df.saveAsCsvWithSchema(<span class="lit">"/tmp/output/test.csv"</span>)</pre></div><dl class="paramcmts block"><dt class="param">dataPath</dt><dd class="cmt"><p>direct path where file is persisted.  Can also be a relative path.  The configured app data/output dir are not considered.</p></dd><dt class="param">ca</dt><dd class="cmt"><p>CSV attributes used to format output file.  Defaults to <code>CsvAttributes.defaultCsv</code></p></dd><dt class="param">schemaWithMeta</dt><dd class="cmt"><p>Provide the companion schema (usually used when we need to persist some schema meta data along with the standard schema)
</p></dd></dl></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#selectByLabel" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="selectByLabel(labels:String*):org.apache.spark.sql.DataFrame"></a>
      <a id="selectByLabel(String*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">selectByLabel</span><span class="params">(<span name="labels">labels: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">DataFrame projection based on labels</p><div class="fullcomment"><div class="comment cmt"><p>DataFrame projection based on labels</p><p>Example:</p><pre><span class="kw">val</span> res = df.selectByLabel(<span class="lit">"yellow"</span>)</pre></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#selectPlusPrefix" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="selectPlusPrefix(exprs:org.apache.spark.sql.Column*):org.apache.spark.sql.DataFrame"></a>
      <a id="selectPlusPrefix(Column*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">selectPlusPrefix</span><span class="params">(<span name="exprs">exprs: <span class="extype" name="org.apache.spark.sql.Column">Column</span>*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Same as selectPlus but the new columns are prepended to result.</p><div class="fullcomment"><div class="comment cmt"><p>Same as selectPlus but the new columns are prepended to result.</p><pre>df.selectPlusPrefix($<span class="lit">"price"</span> * $<span class="lit">"count"</span> as <span class="lit">"amt"</span>)</pre><p><code>amt</code> will be the first column in the output.
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#selectWithReplace" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="selectWithReplace(columns:org.apache.spark.sql.Column*):org.apache.spark.sql.DataFrame"></a>
      <a id="selectWithReplace(Column*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">selectWithReplace</span><span class="params">(<span name="columns">columns: <span class="extype" name="org.apache.spark.sql.Column">Column</span>*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Add, or replace, columns to the data frame.</p><div class="fullcomment"><div class="comment cmt"><p>Add, or replace, columns to the data frame.</p><p>Each column expression in the argument list is added to the data
frame.  If the column is an alias (NamedExpression), any existing
column by the same name as the alias will be replaced by the new
column data.</p><p>Example 1:</p><pre>df.selectWithReplace($<span class="lit">"age"</span> + <span class="num">1</span> as <span class="lit">"age"</span>)</pre><p>will create a new data frame with the same schema and with all
values in the &quot;age&quot; column incremented by 1</p><p>Example 2:</p><pre>df.selectWithReplace($<span class="lit">"age"</span> + <span class="num">1</span>)</pre><p>will create a new data frame with an additional column (named
automatically by spark sql) containing the incremented values in
the &quot;age&quot; column, unless there is already another column that
happens to have the same spark-generated name (in which case that
column will be replaced with the new expression)
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvBinHist" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="smvBinHist(colWithBin:(String,Double)*):Unit"></a>
      <a id="smvBinHist((String,Double)*):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvBinHist</span><span class="params">(<span name="colWithBin">colWithBin: (<span class="extype" name="scala.Predef.String">String</span>, <span class="extype" name="scala.Double">Double</span>)*</span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Print Edd histogram with bins
</p>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvBinHistSave" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="smvBinHistSave(colWithBin:(String,Double)*)(path:String):Unit"></a>
      <a id="smvBinHistSave((String,Double)*)(String):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvBinHistSave</span><span class="params">(<span name="colWithBin">colWithBin: (<span class="extype" name="scala.Predef.String">String</span>, <span class="extype" name="scala.Double">Double</span>)*</span>)</span><span class="params">(<span name="path">path: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Save Edd histogram with bins
</p>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvConcatHist" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="smvConcatHist(cols:Seq[String]*):Unit"></a>
      <a id="smvConcatHist(Seq[String]*):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvConcatHist</span><span class="params">(<span name="cols">cols: <span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Predef.String">String</span>]*</span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Print EDD histogram of a group of cols (joint distribution)
</p>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvConcatHistSave" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="smvConcatHistSave(cols:Seq[String]*)(path:String):Unit"></a>
      <a id="smvConcatHistSave(Seq[String]*)(String):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvConcatHistSave</span><span class="params">(<span name="cols">cols: <span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Predef.String">String</span>]*</span>)</span><span class="params">(<span name="path">path: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Save Edd histogram of a group of cols (joint distribution)
</p>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvCountHist" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="smvCountHist(key:String):Unit"></a>
      <a id="smvCountHist(String):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvCountHist</span><span class="params">(<span name="key">key: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvCountHist" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvCountHist(keys:Seq[String],binSize:Int):Unit"></a>
      <a id="smvCountHist(Seq[String],Int):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvCountHist</span><span class="params">(<span name="keys">keys: <span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Predef.String">String</span>]</span>, <span name="binSize">binSize: <span class="extype" name="scala.Int">Int</span> = <span class="symbol">1</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Print Edd histogram on count of records for a group of given keys</p><div class="fullcomment"><div class="comment cmt"><p>Print Edd histogram on count of records for a group of given keys</p><p>Example Input</p><pre>id, v
<span class="num">1</span>, <span class="num">1.0</span>
<span class="num">1</span>, <span class="num">1.5</span>
<span class="num">2</span>, <span class="num">0.3</span></pre><pre>df.smvCountHist(<span class="std">Seq</span>(<span class="lit">"id"</span>))</pre><p>Output</p><pre>N_id
<span class="num">1</span>     <span class="num">1</span>     <span class="num">33.3</span>%
<span class="num">2</span>     <span class="num">2</span>     <span class="num">66.6</span>%</pre></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvCountHistSave" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="smvCountHistSave(key:String)(path:String):Unit"></a>
      <a id="smvCountHistSave(String)(String):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvCountHistSave</span><span class="params">(<span name="key">key: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="params">(<span name="path">path: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvCountHistSave" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="smvCountHistSave(keys:Seq[String],binSize:Int)(path:String):Unit"></a>
      <a id="smvCountHistSave(Seq[String],Int)(String):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvCountHistSave</span><span class="params">(<span name="keys">keys: <span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Predef.String">String</span>]</span>, <span name="binSize">binSize: <span class="extype" name="scala.Int">Int</span> = <span class="symbol">1</span></span>)</span><span class="params">(<span name="path">path: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Save Edd histogram on count of records for a group of given keys
</p>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvCube" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="smvCube(cols:org.apache.spark.sql.Column*):org.tresamigos.smv.SmvGroupedData"></a>
      <a id="smvCube(Column*):SmvGroupedData"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvCube</span><span class="params">(<span name="cols">cols: <span class="extype" name="org.apache.spark.sql.Column">Column</span>*</span>)</span><span class="result">: <span class="extype" name="org.tresamigos.smv.SmvGroupedData">SmvGroupedData</span></span>
      </span>
      </h4>
      
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvCube" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvCube(col:String,others:String*):org.tresamigos.smv.SmvGroupedData"></a>
      <a id="smvCube(String,String*):SmvGroupedData"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvCube</span><span class="params">(<span name="col">col: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="others">others: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="result">: <span class="extype" name="org.tresamigos.smv.SmvGroupedData">SmvGroupedData</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Similar to the <code>cube</code> Spark DF method, but using &quot;*&quot; instead of null to represent &quot;Any&quot;</p><div class="fullcomment"><div class="comment cmt"><p>Similar to the <code>cube</code> Spark DF method, but using &quot;*&quot; instead of null to represent &quot;Any&quot;</p><p>Example:</p><pre>df.smvCube(<span class="lit">"zip"</span>, <span class="lit">"month"</span>).agg(<span class="lit">"zip"</span>, <span class="lit">"month"</span>, sum(<span class="lit">"v"</span>) as <span class="lit">"v"</span>)</pre></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvDesc" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvDesc(colDescs:(String,String)*):org.apache.spark.sql.DataFrame"></a>
      <a id="smvDesc((String,String)*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvDesc</span><span class="params">(<span name="colDescs">colDescs: (<span class="extype" name="scala.Predef.String">String</span>, <span class="extype" name="scala.Predef.String">String</span>)*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Adds column descriptions</p><div class="fullcomment"><div class="comment cmt"><p>Adds column descriptions</p><p>Example:</p><pre><span class="kw">val</span> res = df.smvDesc(
<span class="lit">"name"</span> -&gt; <span class="lit">"This is customer's name"</span>,
<span class="lit">"sex"</span>  -&gt; <span class="lit">"This is customer's self-identified sex"</span>
)</pre></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvDescFromDF" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvDescFromDF(dfDescs:org.apache.spark.sql.DataFrame):org.apache.spark.sql.DataFrame"></a>
      <a id="smvDescFromDF(DataFrame):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvDescFromDF</span><span class="params">(<span name="dfDescs">dfDescs: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Adds column descriptions with a companion 2-column desciptionDF, which has variable names as
column 1 and corresponding variable descriptions as column 2</p><div class="fullcomment"><div class="comment cmt"><p>Adds column descriptions with a companion 2-column desciptionDF, which has variable names as
column 1 and corresponding variable descriptions as column 2</p><p>Example:</p><pre><span class="kw">val</span> res = df.smvDescFromDF(desciptionDF)</pre></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvDiscoverPK" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvDiscoverPK(n:Integer,debug:Boolean):(Seq[String],Long)"></a>
      <a id="smvDiscoverPK(Integer,Boolean):(Seq[String],Long)"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvDiscoverPK</span><span class="params">(<span name="n">n: <span class="extype" name="java.lang.Integer">Integer</span> = <span class="symbol">10000</span></span>, <span name="debug">debug: <span class="extype" name="scala.Boolean">Boolean</span> = <span class="symbol">false</span></span>)</span><span class="result">: (<span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Predef.String">String</span>], <span class="extype" name="scala.Long">Long</span>)</span>
      </span>
      </h4>
      <p class="shortcomment cmt">Find column combinations which uniquely identify a row from the data
</p><div class="fullcomment"><div class="comment cmt"><p>Find column combinations which uniquely identify a row from the data
</p></div><dl class="paramcmts block"><dt class="param">n</dt><dd class="cmt"><p>number of rows the PK discovery algorithm will run on.</p></dd><dt class="param">debug</dt><dd class="cmt"><p>if true printout debug info</p></dd><dt>returns</dt><dd class="cmt"><p>(list_of_keys, unique-count)</p><p>Please note the algorithm only look for a set of keys which uniquely
identify the row, there could be more key combinations which can also
be the primary key.
</p></dd></dl></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvDoubleBinHistogram" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvDoubleBinHistogram(key:String,column_to_bin:String):org.apache.spark.sql.DataFrame"></a>
      <a id="smvDoubleBinHistogram(String,String):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvDoubleBinHistogram</span><span class="params">(<span name="key">key: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="column_to_bin">column_to_bin: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Add a DoubleBinHistogram column to a DataFrame using single key.</p><div class="fullcomment"><div class="comment cmt"><p>Add a DoubleBinHistogram column to a DataFrame using single key.
Perform a DoubleBinHistogram on the column_to_bin using 1000 bins
The column_to_bin is expected to be of type double</p><pre>df.smvDoubleBinHistogram(key1, col)</pre><p>Create a new column named the same as passed column name to bin post fixed with &quot;_bin&quot;
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvDoubleBinHistogram" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvDoubleBinHistogram(key:String,column_to_bin:String,post_fix:String):org.apache.spark.sql.DataFrame"></a>
      <a id="smvDoubleBinHistogram(String,String,String):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvDoubleBinHistogram</span><span class="params">(<span name="key">key: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="column_to_bin">column_to_bin: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="post_fix">post_fix: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Add a DoubleBinHistogram column to a DataFrame using single key.</p><div class="fullcomment"><div class="comment cmt"><p>Add a DoubleBinHistogram column to a DataFrame using single key.
Perform a DoubleBinHistogram on the column_to_bin using 1000 bins
The column_to_bin is expected to be of type double</p><pre>df.smvDoubleBinHistogram(key1, col, <span class="lit">"_xyz"</span>)</pre><p>Create a new column named the same as passed column name to bin post fixed with post_fix.
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvDoubleBinHistogram" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvDoubleBinHistogram(key:String,column_to_bin:String,num_of_bins:Int):org.apache.spark.sql.DataFrame"></a>
      <a id="smvDoubleBinHistogram(String,String,Int):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvDoubleBinHistogram</span><span class="params">(<span name="key">key: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="column_to_bin">column_to_bin: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="num_of_bins">num_of_bins: <span class="extype" name="scala.Int">Int</span></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Add a DoubleBinHistogram column to a DataFrame using single key.</p><div class="fullcomment"><div class="comment cmt"><p>Add a DoubleBinHistogram column to a DataFrame using single key.
Perform a DoubleBinHistogram on the column_to_bin using the passed number of bins num_of_bins
The column_to_bin is expected to be of type double</p><pre>df.smvDoubleBinHistogram(key, col, <span class="num">100</span>)</pre><p>Create a new column named the same as passed column name to bin post fixed with &quot;_bin&quot;
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvDoubleBinHistogram" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvDoubleBinHistogram(key:String,column_to_bin:String,num_of_bins:Int,post_fix:String):org.apache.spark.sql.DataFrame"></a>
      <a id="smvDoubleBinHistogram(String,String,Int,String):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvDoubleBinHistogram</span><span class="params">(<span name="key">key: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="column_to_bin">column_to_bin: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="num_of_bins">num_of_bins: <span class="extype" name="scala.Int">Int</span></span>, <span name="post_fix">post_fix: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Add a DoubleBinHistogram column to a DataFrame using single key.</p><div class="fullcomment"><div class="comment cmt"><p>Add a DoubleBinHistogram column to a DataFrame using single key.
Perform a DoubleBinHistogram on the column_to_bin using the passed number of bins num_of_bins
The column_to_bin is expected to be of type double</p><pre>df.smvDoubleBinHistogram(key, col, <span class="num">100</span>, <span class="lit">"_xyz"</span>)</pre><p>Create a new column named the same as passed column name to bin post fixed with post_fix.
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvDoubleBinHistogram" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvDoubleBinHistogram(keys:Seq[String],column_to_bin:String):org.apache.spark.sql.DataFrame"></a>
      <a id="smvDoubleBinHistogram(Seq[String],String):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvDoubleBinHistogram</span><span class="params">(<span name="keys">keys: <span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Predef.String">String</span>]</span>, <span name="column_to_bin">column_to_bin: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Add a DoubleBinHistogram column to a DataFrame using multiple keys.</p><div class="fullcomment"><div class="comment cmt"><p>Add a DoubleBinHistogram column to a DataFrame using multiple keys.
Perform a DoubleBinHistogram on  the column_to_bin using 1000 bins
The column_to_bin is expected to be of type double</p><pre>df.smvDoubleBinHistogram(<span class="std">Seq</span>(<span class="lit">"key1"</span>, <span class="lit">"key2"</span>), col)</pre><p>Create a new column named the same as passed column name to bin post fixed with &quot;_bin&quot;
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvDoubleBinHistogram" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvDoubleBinHistogram(keys:Seq[String],column_to_bin:String,post_fix:String):org.apache.spark.sql.DataFrame"></a>
      <a id="smvDoubleBinHistogram(Seq[String],String,String):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvDoubleBinHistogram</span><span class="params">(<span name="keys">keys: <span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Predef.String">String</span>]</span>, <span name="column_to_bin">column_to_bin: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="post_fix">post_fix: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Add a DoubleBinHistogram column to a DataFrame using multiple keys.</p><div class="fullcomment"><div class="comment cmt"><p>Add a DoubleBinHistogram column to a DataFrame using multiple keys.
Perform a DoubleBinHistogram on  the column_to_bin using 1000 bins
The column_to_bin is expected to be of type double</p><pre>df.smvDoubleBinHistogram(<span class="std">Seq</span>(<span class="lit">"key1"</span>, <span class="lit">"key2"</span>), col)</pre><p>Create a new column named the same as passed column name to bin post fixed with post_fix.
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvDoubleBinHistogram" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvDoubleBinHistogram(keys:Seq[String],column_to_bin:String,num_of_bins:Int):org.apache.spark.sql.DataFrame"></a>
      <a id="smvDoubleBinHistogram(Seq[String],String,Int):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvDoubleBinHistogram</span><span class="params">(<span name="keys">keys: <span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Predef.String">String</span>]</span>, <span name="column_to_bin">column_to_bin: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="num_of_bins">num_of_bins: <span class="extype" name="scala.Int">Int</span></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Add a DoubleBinHistogram column to a DataFrame using multiple keys.</p><div class="fullcomment"><div class="comment cmt"><p>Add a DoubleBinHistogram column to a DataFrame using multiple keys.
Perform a DoubleBinHistogram on  the column_to_bin using the passed number of bins num_of_bins
The column_to_bin is expected to be of type double</p><pre>df.smvDoubleBinHistogram(<span class="std">Seq</span>(<span class="lit">"key1"</span>, <span class="lit">"key2"</span>), col, <span class="num">100</span>)</pre><p>Create a new column named the same as passed column name to bin post fixed with &quot;_bin&quot;
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvDoubleBinHistogram" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvDoubleBinHistogram(keys:Seq[String],column_to_bin:String,num_of_bins:Int,post_fix:String):org.apache.spark.sql.DataFrame"></a>
      <a id="smvDoubleBinHistogram(Seq[String],String,Int,String):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvDoubleBinHistogram</span><span class="params">(<span name="keys">keys: <span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Predef.String">String</span>]</span>, <span name="column_to_bin">column_to_bin: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="num_of_bins">num_of_bins: <span class="extype" name="scala.Int">Int</span></span>, <span name="post_fix">post_fix: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Add a DoubleBinHistogram column to a DataFrame using multiple keys.</p><div class="fullcomment"><div class="comment cmt"><p>Add a DoubleBinHistogram column to a DataFrame using multiple keys.
Perform a DoubleBinHistogram on  the column_to_bin using the passed number of bins num_of_bins
The column_to_bin is expected to be of type double</p><pre>df.smvDoubleBinHistogram(<span class="std">Seq</span>(<span class="lit">"key1"</span>, <span class="lit">"key2"</span>), col, <span class="num">100</span>)</pre><p>Create a new column named the same as passed column name to bin post fixed with post_fix.
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvDoubleBinHistogram" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvDoubleBinHistogram(keys:Seq[String],columns_to_bin:Seq[String],num_of_bins:Seq[Int],post_fix:String):org.apache.spark.sql.DataFrame"></a>
      <a id="smvDoubleBinHistogram(Seq[String],Seq[String],Seq[Int],String):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvDoubleBinHistogram</span><span class="params">(<span name="keys">keys: <span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Predef.String">String</span>]</span>, <span name="columns_to_bin">columns_to_bin: <span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Predef.String">String</span>]</span>, <span name="num_of_bins">num_of_bins: <span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Int">Int</span>] = <span class="symbol">Seq[Int]()</span></span>, <span name="post_fix">post_fix: <span class="extype" name="scala.Predef.String">String</span> = <span class="symbol">&quot;_bin&quot;</span></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Add a set of DoubleBinHistogram columns to a DataFrame.</p><div class="fullcomment"><div class="comment cmt"><p>Add a set of DoubleBinHistogram columns to a DataFrame.
Perform a DoubleBinHistogram on all the columns_to_bin. The num_of_bins is the corresponding
number of bin for each column in columns_to_bin.
The default number of bin is 1000, if the size of num_of_bins is less then the size of columns_to_bin,
only the extra columns that does not have the corresponding number of bin will be default to 1000
The columns_to_bin are expected to be of type double</p><pre>df.smvDoubleBinHistogram(<span class="std">Seq</span>(<span class="lit">"key1"</span>, <span class="lit">"key2"</span>), <span class="std">Seq</span>(col1, col2), <span class="std">Seq</span>(<span class="num">100</span>, <span class="num">200</span>))</pre><p>Create a new columns named the same as the columns to bin post fixed with post_fix.
The post_fix  is defaulted to &quot;_bin&quot;
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvDumpDF" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvDumpDF():Unit"></a>
      <a id="smvDumpDF():Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvDumpDF</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Dump the schema and data of given df to screen for debugging purposes.</p><div class="fullcomment"><div class="comment cmt"><p>Dump the schema and data of given df to screen for debugging purposes.
Similar to <code>show()</code> method of DF from Spark 1.3, although the format is slightly different.
This function's format is more convenient for us and hence has remaint.
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvEdd" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvEdd(cols:String*):Unit"></a>
      <a id="smvEdd(String*):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvEdd</span><span class="params">(<span name="cols">cols: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Print EDD summary</p><div class="fullcomment"><div class="comment cmt"><p>Print EDD summary</p><pre>df.smvEdd()</pre><p>Perform EDD summary on all columns</p><pre>df.smvEdd(<span class="lit">"a"</span>, <span class="lit">"b"</span>)</pre><p>Perform EDD summary on specified columns
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvEddCompare" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvEddCompare(df2:org.apache.spark.sql.DataFrame,ignoreColName:Boolean):Unit"></a>
      <a id="smvEddCompare(DataFrame,Boolean):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvEddCompare</span><span class="params">(<span name="df2">df2: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>, <span name="ignoreColName">ignoreColName: <span class="extype" name="scala.Boolean">Boolean</span> = <span class="symbol">false</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Compare 2 DFs by comparing their Edd Summary result</p><div class="fullcomment"><div class="comment cmt"><p>Compare 2 DFs by comparing their Edd Summary result</p><p>Example</p><pre>df.smvEddCompare(df2)
df.smvEddCompare(df2, ignoreColName = <span class="kw">true</span>)</pre><p>Print out comparing result
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvEddSave" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="smvEddSave(cols:String*)(path:String):Unit"></a>
      <a id="smvEddSave(String*)(String):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvEddSave</span><span class="params">(<span name="cols">cols: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="params">(<span name="path">path: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Save Edd summary
</p>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvExpandStruct" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvExpandStruct(colNames:String*):org.apache.spark.sql.DataFrame"></a>
      <a id="smvExpandStruct(String*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvExpandStruct</span><span class="params">(<span name="colNames">colNames: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Expand structure type column to a group of columns
Example input df:</p><div class="fullcomment"><div class="comment cmt"><p>Expand structure type column to a group of columns
Example input df:</p><pre>[id:string, address: struct&lt;state:string, zip:string, street:string&gt;]</pre><p>output df:</p><pre>[id:string, state:string, zip:string, street:string]</pre><p>Example code:</p><pre>df.smvExpandStruct(<span class="lit">"address"</span>)</pre></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvExportCsv" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvExportCsv(path:String,n:Integer):Unit"></a>
      <a id="smvExportCsv(String,Integer):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvExportCsv</span><span class="params">(<span name="path">path: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="n">n: <span class="extype" name="java.lang.Integer">Integer</span> = <span class="symbol">null</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Export DF to local file system.</p><div class="fullcomment"><div class="comment cmt"><p>Export DF to local file system. Path is relative to the app runing dir
</p></div><dl class="paramcmts block"><dt class="param">path</dt><dd class="cmt"><p>relative path to the app runing dir on local file system (instead of HDFS)</p></dd><dt class="param">n</dt><dd class="cmt"><p>number of records to be exported. Defualt is to export every records</p><p>**NOTE** since we have to collect the DF and then call JAVA file operations, the job
have to be launched as either local or yar-client mode. Also it is user's responsibility
to make sure that the DF is small enought to fit into memory.
</p></dd></dl></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvFreqHist" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="smvFreqHist(cols:String*):Unit"></a>
      <a id="smvFreqHist(String*):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvFreqHist</span><span class="params">(<span name="cols">cols: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Print EDD histogram with frequency sorting
</p>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvFreqHistSave" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="smvFreqHistSave(cols:String*)(path:String):Unit"></a>
      <a id="smvFreqHistSave(String*)(String):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvFreqHistSave</span><span class="params">(<span name="cols">cols: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="params">(<span name="path">path: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Save Edd histogram with frequency sorting
</p>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvGetDesc" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="smvGetDesc():Seq[(String,String)]"></a>
      <a id="smvGetDesc():Seq[(String,String)]"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvGetDesc</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Seq">Seq</span>[(<span class="extype" name="scala.Predef.String">String</span>, <span class="extype" name="scala.Predef.String">String</span>)]</span>
      </span>
      </h4>
      <p class="shortcomment cmt">Return the sequence of field name - description pairs
</p>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvGetDesc" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="smvGetDesc(colName:String):String"></a>
      <a id="smvGetDesc(String):String"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvGetDesc</span><span class="params">(<span name="colName">colName: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="scala.Predef.String">String</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Return column description of a specified column (by name string)
</p>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvGetLabels" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="smvGetLabels(col:String):Seq[String]"></a>
      <a id="smvGetLabels(String):Seq[String]"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvGetLabels</span><span class="params">(<span name="col">col: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Predef.String">String</span>]</span>
      </span>
      </h4>
      <p class="shortcomment cmt">Returns all the labels on a specified column; throws if the column is missing</p>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvGroupBy" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvGroupBy(col:String,others:String*):org.tresamigos.smv.SmvGroupedData"></a>
      <a id="smvGroupBy(String,String*):SmvGroupedData"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvGroupBy</span><span class="params">(<span name="col">col: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="others">others: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="result">: <span class="extype" name="org.tresamigos.smv.SmvGroupedData">SmvGroupedData</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Same as <code>smvGroupBy(Column*)</code> but uses <code>String</code> to specify the columns.</p><div class="fullcomment"><div class="comment cmt"><p>Same as <code>smvGroupBy(Column*)</code> but uses <code>String</code> to specify the columns.
Note: This is going away shortly and user will be able to use standard Spark <code>groupBy</code> method directly.
</p></div><dl class="attributes block"> <dt>Annotations</dt><dd>
                <span class="name">@Experimental</span><span class="args">()</span>
              
        </dd></dl></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvGroupBy" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvGroupBy(cols:org.apache.spark.sql.Column*):org.tresamigos.smv.SmvGroupedData"></a>
      <a id="smvGroupBy(Column*):SmvGroupedData"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvGroupBy</span><span class="params">(<span name="cols">cols: <span class="extype" name="org.apache.spark.sql.Column">Column</span>*</span>)</span><span class="result">: <span class="extype" name="org.tresamigos.smv.SmvGroupedData">SmvGroupedData</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Similar to groupBy, instead of creating GroupedData, create an <code>SmvGroupedData</code> object.</p><div class="fullcomment"><div class="comment cmt"><p>Similar to groupBy, instead of creating GroupedData, create an <code>SmvGroupedData</code> object.
See <a href="SmvGroupedDataFunc.html" class="extype" name="org.tresamigos.smv.SmvGroupedDataFunc">org.tresamigos.smv.SmvGroupedDataFunc</a> for list of functions that can be applied to the grouped data.</p><p>Note: This is going away shortly and user will be able to use standard Spark <code>groupBy</code> method directly.</p><p>Example:</p><pre>df.smvGroup($<span class="lit">"k"</span>).</pre></div><dl class="attributes block"> <dt>Annotations</dt><dd>
                <span class="name">@Experimental</span><span class="args">()</span>
              
        </dd></dl></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvHashSample" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvHashSample(key:org.apache.spark.sql.Column,rate:Double,seed:Int):org.apache.spark.sql.DataFrame"></a>
      <a id="smvHashSample(Column,Double,Int):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvHashSample</span><span class="params">(<span name="key">key: <span class="extype" name="org.apache.spark.sql.Column">Column</span></span>, <span name="rate">rate: <span class="extype" name="scala.Double">Double</span> = <span class="symbol">0.01</span></span>, <span name="seed">seed: <span class="extype" name="scala.Int">Int</span> = <span class="symbol">23</span></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Sample the df according to the hash of a column.</p><div class="fullcomment"><div class="comment cmt"><p>Sample the df according to the hash of a column.
MurmurHash3 algorithm is used for generating the hash</p><pre>df.smvHashSample($<span class="lit">"key"</span>, rate=<span class="num">0.1</span>, seed=<span class="num">123</span>)</pre></div><dl class="paramcmts block"><dt class="param">key</dt><dd class="cmt"><p>column to sample on.</p></dd><dt class="param">rate</dt><dd class="cmt"><p>sample rate in range (0, 1] with a default of 0.01 (1%)</p></dd><dt class="param">seed</dt><dd class="cmt"><p>random generator integer seed with a default of 23.
</p></dd></dl></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvHist" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="smvHist(cols:String*):Unit"></a>
      <a id="smvHist(String*):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvHist</span><span class="params">(<span name="cols">cols: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Print EDD histogram (each col's histogram prints separately)
</p>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvHistSave" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="smvHistSave(cols:String*)(path:String):Unit"></a>
      <a id="smvHistSave(String*)(String):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvHistSave</span><span class="params">(<span name="cols">cols: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="params">(<span name="path">path: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Save Edd histogram
</p>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvJoinByKey" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvJoinByKey(otherPlan:org.apache.spark.sql.DataFrame,keys:Seq[String],joinType:String,postfix:String,dropRightKey:Boolean):org.apache.spark.sql.DataFrame"></a>
      <a id="smvJoinByKey(DataFrame,Seq[String],String,String,Boolean):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvJoinByKey</span><span class="params">(<span name="otherPlan">otherPlan: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>, <span name="keys">keys: <span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Predef.String">String</span>]</span>, <span name="joinType">joinType: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="postfix">postfix: <span class="extype" name="scala.Predef.String">String</span> = <span class="symbol">null</span></span>, <span name="dropRightKey">dropRightKey: <span class="extype" name="scala.Boolean">Boolean</span> = <span class="symbol">true</span></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">The Spark <code>DataFrame</code> join operation does not handle duplicate key names.</p><div class="fullcomment"><div class="comment cmt"><p>The Spark <code>DataFrame</code> join operation does not handle duplicate key names.
If both left and right side of the join operation contain the same key,
the result <code>DataFrame</code> is unusable.</p><p>The <code>smvJoinByKey</code> method will allow the user to join two <code>DataFrames</code> using the same join key.
Post join, only the left side keys will remain. In case of outer-join, the
<code>coalesce(leftkey, rightkey)</code> will replace the left key to be kept.</p><pre>df1.smvJoinByKey(df2, <span class="std">Seq</span>(<span class="lit">"k"</span>), SmvJoinType.Inner)</pre><p>Note the use of the <code>SmvJoinType.Inner</code> const instead of the naked &quot;inner&quot; string.</p><p>If, in addition to the duplicate keys, both df1 and df2 have column with name &quot;v&quot;,
both will be kept in the result, but the df2 version will be prefix with &quot;_&quot; if no
<code>postfix</code> parameter is specified, otherwise df2 version with be postfixed with
the specified <code>postfix</code>.
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvJoinMultipleByKey" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvJoinMultipleByKey(keys:Seq[String],defaultJoinType:String):org.tresamigos.smv.SmvMultiJoin"></a>
      <a id="smvJoinMultipleByKey(Seq[String],String):SmvMultiJoin"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvJoinMultipleByKey</span><span class="params">(<span name="keys">keys: <span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Predef.String">String</span>]</span>, <span name="defaultJoinType">defaultJoinType: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <a href="SmvMultiJoin.html" class="extype" name="org.tresamigos.smv.SmvMultiJoin">SmvMultiJoin</a></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Create multiple DF join builder: <code>SmvMultiJoin</code>.</p><div class="fullcomment"><div class="comment cmt"><p>Create multiple DF join builder: <code>SmvMultiJoin</code>.</p><p>Example:</p><pre>df.joinMultipleByKey(<span class="std">Seq</span>(<span class="lit">"k1"</span>, <span class="lit">"k2"</span>), Inner).
joinWith(df2, <span class="lit">"_df2"</span>).
joinWith(df3, <span class="lit">"_df3"</span>, LeftOuter).
doJoin()</pre><p>In above example, <code>df</code> will inner join with <code>df2</code> on <code>k1</code> and <code>k2</code>, then
left outer join with <code>df3</code> with the same keys.
In the cases that there are columns with the same name, df2's column will be
renamed with postfix &quot;_df2&quot;, and, df3's column will be renamed with postfix
&quot;_df3&quot;.
</p></div><dl class="paramcmts block"><dt>returns</dt><dd class="cmt"><p>an <code>SmvMultiJoin</code> object which support <code>joinWith</code> and <code>doJoin</code> method
</p></dd></dl></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvLabel" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvLabel(colNames:String*)(labels:String*):org.apache.spark.sql.DataFrame"></a>
      <a id="smvLabel(String*)(String*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvLabel</span><span class="params">(<span name="colNames">colNames: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="params">(<span name="labels">labels: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Adds labels to the specified columns.</p><div class="fullcomment"><div class="comment cmt"><p>Adds labels to the specified columns.</p><p>Each column could have multiple labels.</p><p>Example:</p><pre><span class="kw">val</span> res = df.smvLabel(<span class="lit">"name"</span>, <span class="lit">"sex"</span>)(<span class="lit">"red"</span>, <span class="lit">"yellow"</span>).smvLabel(<span class="lit">"sex"</span>)(<span class="lit">"green"</span>)</pre><p>In this example, assume df has no labels, the res' &quot;name&quot; column will have
&quot;red&quot; and &quot;yellow&quot; labels, and &quot;sex&quot; column will have &quot;red&quot;, &quot;yellow&quot;, and &quot;green&quot;
labels.
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvOverlapCheck" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvOverlapCheck(key:String,partition:Int)(dfother:org.apache.spark.sql.DataFrame*):org.apache.spark.sql.DataFrame"></a>
      <a id="smvOverlapCheck(String,Int)(DataFrame*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvOverlapCheck</span><span class="params">(<span name="key">key: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="partition">partition: <span class="extype" name="scala.Int">Int</span> = <span class="symbol">4</span></span>)</span><span class="params">(<span name="dfother">dfother: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span>*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">For a set of DFs, which share the same key column, check the overlap across them.</p><div class="fullcomment"><div class="comment cmt"><p>For a set of DFs, which share the same key column, check the overlap across them.</p><pre>df1.smvOverlapCheck(<span class="lit">"key"</span>)(df2, df3, df4)</pre><p>The output is another DF with 2 columns:</p><pre>key, flag</pre><p>where flag is a bit string, e.g. 0110. Each bit represent whether the original DF has
this key.</p><p>It can be used with EDD to summarize on the flag:</p><pre>df1.smvOverlapCheck(<span class="lit">"key"</span>)(df2, df3).smvHist(<span class="lit">"flag"</span>)</pre></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvPivot" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvPivot(pivotCols:Seq[String]*)(valueCols:String*)(baseOutput:String*):org.apache.spark.sql.DataFrame"></a>
      <a id="smvPivot(Seq[String]*)(String*)(String*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvPivot</span><span class="params">(<span name="pivotCols">pivotCols: <span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Predef.String">String</span>]*</span>)</span><span class="params">(<span name="valueCols">valueCols: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="params">(<span name="baseOutput">baseOutput: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">smvPivot adds the pivoted columns without additional
aggregation.</p><div class="fullcomment"><div class="comment cmt"><p>smvPivot adds the pivoted columns without additional
aggregation. In other words N records in, N records out</p><p>Please note that no keyCols need to be provided, since all original
columns will be kept</p><p>Example:</p><pre>df.smvPivot(<span class="std">Seq</span>(<span class="lit">"month"</span>, <span class="lit">"product"</span>))(<span class="lit">"count"</span>)(<span class="lit">"5_14_A"</span>, <span class="lit">"5_14_B"</span>, <span class="lit">"6_14_A"</span>, <span class="lit">"6_14_B"</span>)</pre><pre>Input
| id  | month | product | count |
| --- | ----- | ------- | ----- |
| <span class="num">1</span>   | <span class="num">5</span>/<span class="num">14</span>  |   A     |   <span class="num">100</span> |
| <span class="num">1</span>   | <span class="num">6</span>/<span class="num">14</span>  |   B     |   <span class="num">200</span> |
| <span class="num">1</span>   | <span class="num">5</span>/<span class="num">14</span>  |   B     |   <span class="num">300</span> |

Output
| id  | month | product | count | count_5_14_A | count_5_14_B | count_6_14_A | count_6_14_B |
| --- | ----- | ------- | ----- | ------------ | ------------ | ------------ | ------------ |
| <span class="num">1</span>   | <span class="num">5</span>/<span class="num">14</span>  |   A     |   <span class="num">100</span> | <span class="num">100</span>          | NULL         | NULL         | NULL         |
| <span class="num">1</span>   | <span class="num">6</span>/<span class="num">14</span>  |   B     |   <span class="num">200</span> | NULL         | NULL         | NULL         | <span class="num">200</span>          |
| <span class="num">1</span>   | <span class="num">5</span>/<span class="num">14</span>  |   B     |   <span class="num">300</span> | NULL         | <span class="num">300</span>          | NULL         | NULL         |</pre></div><dl class="paramcmts block"><dt class="param">pivotCols</dt><dd class="cmt"><p>The sequence of column names whose values will be used as the output pivot column names.</p></dd><dt class="param">valueCols</dt><dd class="cmt"><p>The columns whose value will be copied to the pivoted output columns.</p></dd><dt class="param">baseOutput</dt><dd class="cmt"><p>The expected base output column names (without the value column prefix).
                  The user is required to supply the list of expected pivot column output names to avoid
                  and extra action on the input DataFrame just to extract the possible pivot columns.
</p></dd></dl></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvRank" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvRank(rankColumnName:String,startValue:Long):org.apache.spark.sql.DataFrame"></a>
      <a id="smvRank(String,Long):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvRank</span><span class="params">(<span name="rankColumnName">rankColumnName: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="startValue">startValue: <span class="extype" name="scala.Long">Long</span> = <span class="symbol">0</span></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Add a rank/sequence column to a DataFrame.</p><div class="fullcomment"><div class="comment cmt"><p>Add a rank/sequence column to a DataFrame.
It uses <code>zipWithIndex</code> method of <code>RDD</code> to add a sequence number to records in a DF.
It ranks records sequentially by partition.
Please refer to Spark's document for the detail behavior of <code>zipWithIndex</code>.
<b>Note:</b> May force an action on the DataFrame if the DataFrame has more than one partition.</p><pre>df.smvRank(<span class="lit">"seqId"</span>, <span class="num">100</span>L)</pre><p>Create a new column named &quot;seqId&quot; and start from 100.
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvRemoveDesc" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvRemoveDesc(colNames:String*):org.apache.spark.sql.DataFrame"></a>
      <a id="smvRemoveDesc(String*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvRemoveDesc</span><span class="params">(<span name="colNames">colNames: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Remove descriptions from specified columns (by name string)
If parameter is empty, </p><div class="fullcomment"><div class="comment cmt"><p>Remove descriptions from specified columns (by name string)
If parameter is empty, </p><pre>df.smvRemoveDesc()</pre><p>, remove all descriptions</p><p>df.smvRemoveDesc()
}}}
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvRemoveLabel" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvRemoveLabel(colNames:String*)(labels:String*):org.apache.spark.sql.DataFrame"></a>
      <a id="smvRemoveLabel(String*)(String*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvRemoveLabel</span><span class="params">(<span name="colNames">colNames: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="params">(<span name="labels">labels: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Removes the specified labels from the specified columns.</p><div class="fullcomment"><div class="comment cmt"><p>Removes the specified labels from the specified columns.</p><p>Example:</p><pre>df.smvRemoveLabel(<span class="lit">"sex"</span>)(<span class="lit">"yellow"</span>, <span class="lit">"green"</span>)</pre><p>If no columns are specified, the specified labels are removed
from all applicable columns in the data frame.</p><p>If no labels are specified, all labels are removed from the
specified columns.</p><p>If neither columns nor labels are specified, i.e. both parameter
lists are empty, then all labels are removed from all columns in
the data frame, essentially clearing the label meta data.
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvRenameField" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvRenameField(namePairs:(String,String)*):org.apache.spark.sql.DataFrame"></a>
      <a id="smvRenameField((String,String)*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvRenameField</span><span class="params">(<span name="namePairs">namePairs: (<span class="extype" name="scala.Predef.String">String</span>, <span class="extype" name="scala.Predef.String">String</span>)*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Rename one or more fields of a <code>DataFrame</code>.</p><div class="fullcomment"><div class="comment cmt"><p>Rename one or more fields of a <code>DataFrame</code>.
The old/new names are given as string pairs.</p><pre>df.smvRenameField( <span class="lit">"a"</span> -&gt; <span class="lit">"aa"</span>, <span class="lit">"b"</span> -&gt; <span class="lit">"bb"</span> )</pre><p>The method preserves any pre-existing metadata associated with
renamed columns, whereas the method withColumnRenamed in Spark,
as of 1.5.2, would drop them.
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvRollup" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="smvRollup(cols:org.apache.spark.sql.Column*):org.tresamigos.smv.SmvGroupedData"></a>
      <a id="smvRollup(Column*):SmvGroupedData"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvRollup</span><span class="params">(<span name="cols">cols: <span class="extype" name="org.apache.spark.sql.Column">Column</span>*</span>)</span><span class="result">: <span class="extype" name="org.tresamigos.smv.SmvGroupedData">SmvGroupedData</span></span>
      </span>
      </h4>
      
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvRollup" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvRollup(col:String,others:String*):org.tresamigos.smv.SmvGroupedData"></a>
      <a id="smvRollup(String,String*):SmvGroupedData"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvRollup</span><span class="params">(<span name="col">col: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="others">others: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="result">: <span class="extype" name="org.tresamigos.smv.SmvGroupedData">SmvGroupedData</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Similar to the <code>rollup</code> Spark DF method, but using &quot;*&quot; instead of null to represent &quot;Any&quot;</p><div class="fullcomment"><div class="comment cmt"><p>Similar to the <code>rollup</code> Spark DF method, but using &quot;*&quot; instead of null to represent &quot;Any&quot;</p><p>Example:</p><pre>df.smvRollup(<span class="lit">"county"</span>, <span class="lit">"zip"</span>).agg(<span class="lit">"county"</span>, <span class="lit">"zip"</span>, sum(<span class="lit">"v"</span>) as <span class="lit">"v"</span>)</pre></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvSelectMinus" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvSelectMinus(cols:org.apache.spark.sql.Column*):org.apache.spark.sql.DataFrame"></a>
      <a id="smvSelectMinus(Column*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvSelectMinus</span><span class="params">(<span name="cols">cols: <span class="extype" name="org.apache.spark.sql.Column">Column</span>*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Remove one or more columns from current DataFrame.</p><div class="fullcomment"><div class="comment cmt"><p>Remove one or more columns from current DataFrame.
Column names are specified as <code>Column</code></p><pre>df.smvSelectMinus($<span class="lit">"col1"</span>, df(<span class="lit">"col2"</span>))</pre></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvSelectMinus" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvSelectMinus(s:String,others:String*):org.apache.spark.sql.DataFrame"></a>
      <a id="smvSelectMinus(String,String*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvSelectMinus</span><span class="params">(<span name="s">s: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="others">others: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Remove one or more columns from current DataFrame.</p><div class="fullcomment"><div class="comment cmt"><p>Remove one or more columns from current DataFrame.
Column names are specified as string.</p><pre>df.smvSelectMinus(<span class="lit">"col1"</span>, <span class="lit">"col2"</span>)</pre></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvSelectPlus" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvSelectPlus(exprs:org.apache.spark.sql.Column*):org.apache.spark.sql.DataFrame"></a>
      <a id="smvSelectPlus(Column*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvSelectPlus</span><span class="params">(<span name="exprs">exprs: <span class="extype" name="org.apache.spark.sql.Column">Column</span>*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">selects all the current columns in current <code>DataFrame</code> plus the supplied expressions.</p><div class="fullcomment"><div class="comment cmt"><p>selects all the current columns in current <code>DataFrame</code> plus the supplied expressions.
The new columns are added to the end of the current column list.</p><pre>df.smvSelectPlus($<span class="lit">"price"</span> * $<span class="lit">"count"</span> as <span class="lit">"amt"</span>)</pre></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvSkewJoinByKey" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvSkewJoinByKey(df2:org.apache.spark.sql.DataFrame,joinType:String,skewVals:Seq[Any],key:String):org.apache.spark.sql.DataFrame"></a>
      <a id="smvSkewJoinByKey(DataFrame,String,Seq[Any],String):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvSkewJoinByKey</span><span class="params">(<span name="df2">df2: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>, <span name="joinType">joinType: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="skewVals">skewVals: <span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Any">Any</span>]</span>, <span name="key">key: <span class="extype" name="scala.Predef.String">String</span></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Join that leverages broadcast (map-side) join of skewed (high-frequency) key values</p><div class="fullcomment"><div class="comment cmt"><p>Join that leverages broadcast (map-side) join of skewed (high-frequency) key values</p><p> Rows keyed by skewed values are joined via broadcast join while remaining
 rows are joined without broadcast join. Occurrences of skewVals in df2 should be
 infrequent enough that the filtered table is small enough for a broadcast join.
 result is the union of the join results.</p><p> Example:</p><pre>df.smvSkewJoinByKey(df2, SmvJoinType.Inner, <span class="std">Seq</span>(<span class="lit">"9999999"</span>), <span class="lit">"cid"</span>)</pre><p> will broadcast join the rows of df1 and df2 where col(&quot;cid&quot;) == &quot;9999999&quot;
 and join the remaining rows of df1 and df2 without broadcast join.
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvTopNRecs" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvTopNRecs(maxElems:Int,orders:org.apache.spark.sql.Column*):org.apache.spark.sql.DataFrame"></a>
      <a id="smvTopNRecs(Int,Column*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvTopNRecs</span><span class="params">(<span name="maxElems">maxElems: <span class="extype" name="scala.Int">Int</span></span>, <span name="orders">orders: <span class="extype" name="org.apache.spark.sql.Column">Column</span>*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">For return the global top N records according to an ordering</p><div class="fullcomment"><div class="comment cmt"><p>For return the global top N records according to an ordering</p><p>Example:</p><pre>df.smvTopNRecs(<span class="num">3</span>, $<span class="lit">"amt"</span>.desc)</pre><p>Will keep the 3 largest amt records
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvUnion" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvUnion(dfothers:org.apache.spark.sql.DataFrame*):org.apache.spark.sql.DataFrame"></a>
      <a id="smvUnion(DataFrame*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvUnion</span><span class="params">(<span name="dfothers">dfothers: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span>*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">smvUnion unions DataFrames with different number of columns by column name &amp; schema.</p><div class="fullcomment"><div class="comment cmt"><p>smvUnion unions DataFrames with different number of columns by column name &amp; schema.
spark unionAll ignores column names &amp; schema, and can only be performed on tables with the same number of columns.
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvUnpivot" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvUnpivot(valueCols:String*):org.apache.spark.sql.DataFrame"></a>
      <a id="smvUnpivot(String*):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvUnpivot</span><span class="params">(<span name="valueCols">valueCols: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Almost the opposite of the pivot operation.</p><div class="fullcomment"><div class="comment cmt"><p>Almost the opposite of the pivot operation.
Given a set of records with value columns, turns the value columns into value rows.
For example, Given the following input:</p><pre>| id | X | Y | Z |
| -- | - | - | - |
| <span class="num">1</span>  | A | B | C |
| <span class="num">2</span>  | D | E | F |
| <span class="num">3</span>  | G | H | I |</pre><p>and the following command:</p><pre>df.smvUnpivot(<span class="lit">"X"</span>, <span class="lit">"Y"</span>, <span class="lit">"Z"</span>)</pre><p>will result in the following output:</p><pre>| id | column | value |
| -- | ------ | ----- |
|  <span class="num">1</span> |   X    |   A   |
|  <span class="num">1</span> |   Y    |   B   |
|  <span class="num">1</span> |   Z    |   C   |
| ...   ...      ...  |
|  <span class="num">3</span> |   Y    |   H   |
|  <span class="num">3</span> |   Z    |   I   |</pre><p><b>Warning:</b> This only works for String columns for now (due to limitation of Explode method)
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvUnpivot" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvUnpivot(valueCols:Seq[String],colNameFn:String=&gt;(String,String),indexColName:Option[String]):org.apache.spark.sql.DataFrame"></a>
      <a id="smvUnpivot(Seq[String],(String)⇒(String,String),Option[String]):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvUnpivot</span><span class="params">(<span name="valueCols">valueCols: <span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Predef.String">String</span>]</span>, <span name="colNameFn">colNameFn: (<span class="extype" name="scala.Predef.String">String</span>) ⇒ (<span class="extype" name="scala.Predef.String">String</span>, <span class="extype" name="scala.Predef.String">String</span>)</span>, <span name="indexColName">indexColName: <span class="extype" name="scala.Option">Option</span>[<span class="extype" name="scala.Predef.String">String</span>] = <span class="symbol">Some(&quot;Index&quot;)</span></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">The reverse of smvPivot.</p><div class="fullcomment"><div class="comment cmt"><p>The reverse of smvPivot.  Specifically, given the following table</p><p>+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|  Id   |  A_1  |  A_2  |  ...  | A_11  |  B_1  |  ...  | B_11  |  ...  |  Z_1  |  ...  | Z_11  |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|   1   | 1_a_1 | 1_a_2 |  ...  |1_a_11 | 1_b_1 |  ...  |1_b_11 |  ...  | 1_z_1 |  ...  |1_z_11 |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+
|   2   | 2_a_1 | 2_a_2 |  ...  |2_a_11 | 2_b_1 |  ...  |2_b_11 |  ...  | 2_z_1 |  ...  |2_z_11 |
+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+</p><p>and a function that would map &quot;A_1&quot; to (&quot;A&quot;, &quot;1&quot;), unpivoting all
columns except 'Id' (in other words, valueCols === columns - <code>Id</code>)
would transform the table into the following</p><p>+-----+-----+------+------+-----+-------+
| Id  |Index|  A   |  B   | ... |  Z    |
+-----+-----+------+------+-----+-------+
|  1  |  1  |1_a_1 |1_b_1 | ... |1_z_1  |
+-----+-----+------+------+-----+-------+
|  1  |  2  |1_a_2 |1_b_2 | ... |1_z_2  |
+-----+-----+------+------+-----+-------+
| ... | ... | ...  | ...  | ... | ...   |
+-----+-----+------+------+-----+-------+
|  1  | 11  |1_a_11|1_b_11| ... |1_z_11 |
+-----+-----+------+------+-----+-------+
|  2  |  1  |2_a_1 |2_b_1 | ... | 2_z_1 |
+-----+-----+------+------+-----+-------+
|  2  |  2  |2_a_2 |2_b_2 | ... | 2_z_2 |
+-----+-----+------+------+-----+-------+
| ... | ... | ...  | ...  | ... |  ...  |
+-----+-----+------+------+-----+-------+
|  2  | 11  |2_a_11|2_b_11| ... |2_z_11 |
+-----+-----+------+------+-----+-------+</p><p>See <a href="https://github.com/TresAmigosSD/SMV/issues/243" target="_blank">Issue 243</a>
</p></div><dl class="paramcmts block"><dt class="param">valueCols</dt><dd class="cmt"><p>names of the columns to transpose</p></dd><dt class="param">colNameFn</dt><dd class="cmt"><p>the function that takes a column name and returns a tuple2,
                    the first part is the transposed column name, the second part is the
                    value that goes into the Index column.</p></dd><dt class="param">indexColName</dt><dd class="cmt"><p>the name of the index column, if present, if None, no index column would be added
</p></dd></dl></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvUnpivotRegex" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvUnpivotRegex(valueCols:Seq[String],colNameFn:String,indexColName:String):org.apache.spark.sql.DataFrame"></a>
      <a id="smvUnpivotRegex(Seq[String],String,String):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvUnpivotRegex</span><span class="params">(<span name="valueCols">valueCols: <span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Predef.String">String</span>]</span>, <span name="colNameFn">colNameFn: <span class="extype" name="scala.Predef.String">String</span></span>, <span name="indexColName">indexColName: <span class="extype" name="scala.Predef.String">String</span> = <span class="symbol">&quot;Index&quot;</span></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">a variation of the smvUnpivot function that takes a regex instead of a function.</p><div class="fullcomment"><div class="comment cmt"><p>a variation of the smvUnpivot function that takes a regex instead of a function.
this is due to the following reasons:</p><ul><li>it is not possible to convert any general purpose function from Python smv to Scala, so we resort to using regex instead.</li><li>the python smvUnpivotRegex function takes variable number of arguments. we cannot use default values</li></ul><p>The function name is different to keep consistency between Python and Scala
</p></div></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvWithKeys" visbl="pub" data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="smvWithKeys(cols:String*):org.tresamigos.smv.SmvDFWithKeys"></a>
      <a id="smvWithKeys(String*):SmvDFWithKeys"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvWithKeys</span><span class="params">(<span name="cols">cols: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="result">: <a href="SmvDFWithKeys.html" class="extype" name="org.tresamigos.smv.SmvDFWithKeys">SmvDFWithKeys</a></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Just an alias to smvGroupBy to make client code more readable
</p>
    </li><li name="org.tresamigos.smv.SmvDFHelper#smvWithLabel" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="smvWithLabel(labels:String*):Seq[String]"></a>
      <a id="smvWithLabel(String*):Seq[String]"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">smvWithLabel</span><span class="params">(<span name="labels">labels: <span class="extype" name="scala.Predef.String">String</span>*</span>)</span><span class="result">: <span class="extype" name="scala.Seq">Seq</span>[<span class="extype" name="scala.Predef.String">String</span>]</span>
      </span>
      </h4>
      <p class="shortcomment cmt">Returns all column names in the data frame that contain all the
specified labels.</p><div class="fullcomment"><div class="comment cmt"><p>Returns all column names in the data frame that contain all the
specified labels.  If the labels argument is an empty sequence,
returns all unlabeled columns in the data frame.</p><p>Will throw if there are no columns that satisfy the condition.</p><p>Example:</p><pre><span class="kw">val</span> cols = df.smvWithLabel(<span class="lit">"A"</span>, <span class="lit">"B"</span>)</pre></div></div>
    </li><li name="scala.AnyRef#synchronized" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="synchronized[T0](x$1:=&gt;T0):T0"></a>
      <a id="synchronized[T0](⇒T0):T0"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">synchronized</span><span class="tparams">[<span name="T0">T0</span>]</span><span class="params">(<span name="arg0">arg0: ⇒ <span class="extype" name="java.lang.AnyRef.synchronized.T0">T0</span></span>)</span><span class="result">: <span class="extype" name="java.lang.AnyRef.synchronized.T0">T0</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd></dl></div>
    </li><li name="scala.AnyRef#toString" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="toString():String"></a>
      <a id="toString():String"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">toString</span><span class="params">()</span><span class="result">: <span class="extype" name="java.lang.String">String</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#topNValsByFreq" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="topNValsByFreq(n:Integer,c:org.apache.spark.sql.Column):Array[Any]"></a>
      <a id="topNValsByFreq(Integer,Column):Array[Any]"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">topNValsByFreq</span><span class="params">(<span name="n">n: <span class="extype" name="java.lang.Integer">Integer</span></span>, <span name="c">c: <span class="extype" name="org.apache.spark.sql.Column">Column</span></span>)</span><span class="result">: <span class="extype" name="scala.Array">Array</span>[<span class="extype" name="scala.Any">Any</span>]</span>
      </span>
      </h4>
      <p class="shortcomment cmt">Get top N most frequent values in Column c</p><div class="fullcomment"><div class="comment cmt"><p>Get top N most frequent values in Column c</p><p> Example:</p><pre>df.topNValsByFreq(<span class="num">1</span>, col(<span class="lit">"cid"</span>))</pre><p> will return the single most frequent value in the cid column
</p></div></div>
    </li><li name="scala.AnyRef#wait" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="wait():Unit"></a>
      <a id="wait():Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">wait</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd>
                <span class="name">@throws</span><span class="args">(<span>
      
      <span class="defval" name="classOf[java.lang.InterruptedException]">...</span>
    </span>)</span>
              
        </dd></dl></div>
    </li><li name="scala.AnyRef#wait" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="wait(x$1:Long,x$2:Int):Unit"></a>
      <a id="wait(Long,Int):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">wait</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.Long">Long</span></span>, <span name="arg1">arg1: <span class="extype" name="scala.Int">Int</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd>
                <span class="name">@throws</span><span class="args">(<span>
      
      <span class="defval" name="classOf[java.lang.InterruptedException]">...</span>
    </span>)</span>
              
        </dd></dl></div>
    </li><li name="scala.AnyRef#wait" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="wait(x$1:Long):Unit"></a>
      <a id="wait(Long):Unit"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">wait</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.Long">Long</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      </h4>
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd>
                <span class="name">@throws</span><span class="args">(<span>
      
      <span class="defval" name="classOf[java.lang.InterruptedException]">...</span>
    </span>)</span>
              
        </dd></dl></div>
    </li></ol>
            </div>

        

        <div id="values" class="values members">
              <h3>Deprecated Value Members</h3>
              <ol><li name="org.tresamigos.smv.SmvDFHelper#chunkBy" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="chunkBy(keys:Symbol*)(chunkUDF:org.tresamigos.smv.cds.SmvChunkUDF):org.apache.spark.sql.DataFrame"></a>
      <a id="chunkBy(Symbol*)(SmvChunkUDF):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name deprecated" title="Deprecated: (Since version 1.5) will rename and refine interface">chunkBy</span><span class="params">(<span name="keys">keys: <span class="extype" name="scala.Symbol">Symbol</span>*</span>)</span><span class="params">(<span name="chunkUDF">chunkUDF: <a href="cds/SmvChunkUDF.html" class="extype" name="org.tresamigos.smv.cds.SmvChunkUDF">SmvChunkUDF</a></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Apply user defined <code>chunk</code> mapping on data grouped by a set of keys</p><div class="fullcomment"><div class="comment cmt"><p>Apply user defined <code>chunk</code> mapping on data grouped by a set of keys</p><pre><span class="kw">val</span> addFirst = (l: <span class="std">List</span>[<span class="std">Seq</span>[<span class="std">Any</span>]]) <span class="kw">=&gt;</span> {
  <span class="kw">val</span> firstv = l.head.head
  l.map{r <span class="kw">=&gt;</span> r :+ firstv}
}
<span class="kw">val</span> addFirstFunc = SmvChunkUDF(
     <span class="std">Seq</span>(<span class="lit">'time, '</span>call_length),
     SmvSchema.fromString(<span class="lit">"time: TimeStamp; call_length: Double; first_call_time: TimeStamp"</span>).toStructType,
     addFirst)
df.chunkBy('account, 'cycleId)(addFirstFunc)</pre><p>TODO: Current version will not keep teh key columns. It's SmvChunkUDF's responsibility to
make sure key column is carried. This behavior should be changed to automatically
carry keys, as chanegs made on Spark's groupBy.agg
</p></div><dl class="attributes block"> <dt>Annotations</dt><dd>
                <span class="name">@deprecated</span>
              
        </dd><dt>Deprecated</dt><dd class="cmt"><p><i>(Since version 1.5)</i> will rename and refine interface</p></dd></dl></div>
    </li><li name="org.tresamigos.smv.SmvDFHelper#chunkByPlus" visbl="pub" data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="chunkByPlus(keys:Symbol*)(chunkUDF:org.tresamigos.smv.cds.SmvChunkUDF):org.apache.spark.sql.DataFrame"></a>
      <a id="chunkByPlus(Symbol*)(SmvChunkUDF):DataFrame"></a>
      <h4 class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name deprecated" title="Deprecated: (Since version 1.5) will rename and refine interface">chunkByPlus</span><span class="params">(<span name="keys">keys: <span class="extype" name="scala.Symbol">Symbol</span>*</span>)</span><span class="params">(<span name="chunkUDF">chunkUDF: <a href="cds/SmvChunkUDF.html" class="extype" name="org.tresamigos.smv.cds.SmvChunkUDF">SmvChunkUDF</a></span>)</span><span class="result">: <span class="extype" name="org.apache.spark.sql.DataFrame">DataFrame</span></span>
      </span>
      </h4>
      <p class="shortcomment cmt">Same as <code>chunkBy</code>, but add the new columns to existing columns
</p><div class="fullcomment"><div class="comment cmt"><p>Same as <code>chunkBy</code>, but add the new columns to existing columns
</p></div><dl class="attributes block"> <dt>Annotations</dt><dd>
                <span class="name">@deprecated</span>
              
        </dd><dt>Deprecated</dt><dd class="cmt"><p><i>(Since version 1.5)</i> will rename and refine interface</p></dd></dl></div>
    </li></ol>
            </div>
        </div>

        <div id="inheritedMembers">
        <div class="parent" name="scala.AnyRef">
              <h3>Inherited from <span class="extype" name="scala.AnyRef">AnyRef</span></h3>
            </div><div class="parent" name="scala.Any">
              <h3>Inherited from <span class="extype" name="scala.Any">Any</span></h3>
            </div>
        
        </div>

        <div id="groupedMembers">
        <div class="group" name="Ungrouped">
              <h3>Ungrouped</h3>
              
            </div>
        </div>

      </div>

      <div id="tooltip"></div>

      <div id="footer">  </div>
      <script defer="defer" type="text/javascript" id="jquery-js" src="../../../lib/jquery.js"></script><script defer="defer" type="text/javascript" id="jquery-ui-js" src="../../../lib/jquery-ui.js"></script><script defer="defer" type="text/javascript" id="tools-tooltip-js" src="../../../lib/tools.tooltip.js"></script><script defer="defer" type="text/javascript" id="template-js" src="../../../lib/template.js"></script>
    </body>
      </html>